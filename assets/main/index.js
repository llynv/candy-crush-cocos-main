System.register("chunks:///_virtual/AnimationConfig.ts",["cc"],(function(i){var n;return{setters:[function(i){n=i.cclegacy}],execute:function(){n._RF.push({},"48ef7wzMFJKFrBHyPhWcPlB","AnimationConfig",void 0);i("CONFIG",{SELECTION_CONFIG:{duration:.3,glowDuration:.18,settleDuration:.12,easing:"sineOut"},DRAG_CONFIG:{duration:.2,easing:"backOut",scaleMultiplier:1.3},DESTRUCTION_CONFIG:{duration:.35,easing:"backIn",bounceMultiplier:1.4},SPAWN_CONFIG:{duration:.5,easing:"backOut",scaleMultiplier:1},BOUNCE_CONFIG:{duration:.08,easing:"quadOut",scaleMultiplier:1.25},MOVEMENT_CONFIG:{duration:.25,easing:"quadOut"},PULSE_CONFIG:{duration:.15,easing:"sineInOut",scaleMultiplier:1.08},DESELECTION_CONFIG:{duration:.2,easing:"sineIn"}}),i("COLOR_PRESETS",{SELECTION_GLOW:{r:255,g:255,b:150,a:255},SELECTION_ACTIVE:{r:255,g:255,b:200,a:255},DRAG_TINT:{r:180,g:180,b:255,a:160},ORIGINAL:{r:255,g:255,b:255,a:255},TRANSPARENT:{r:255,g:255,b:255,a:0}});n._RF.pop()}}}));

System.register("chunks:///_virtual/AnimationManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Tile.ts","./GameConfig.ts","./BoardManager.ts","./AnimationConfig.ts","./ParticleEffectManager.ts"],(function(n){var e,t,i,a,o,r,s,l,c,u,d,p,g,f,h,m,w,x,b,P,v,y,S;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,i=n.initializerDefineProperty,a=n.assertThisInitialized,o=n.asyncToGenerator,r=n.regeneratorRuntime,s=n.createForOfIteratorHelperLoose},function(n){l=n.cclegacy,c=n._decorator,u=n.Node,d=n.Vec3,p=n.Color,g=n.tween,f=n.Component,h=n.Tween,m=n.instantiate,w=n.Sprite,x=n.UITransform},function(n){b=n.Tile},function(n){P=n.GameConfig},function(n){v=n.BoardManager},function(n){y=n.CONFIG},function(n){S=n.ParticleEffectManager}],execute:function(){var O,C,I,M,k;l._RF.push({},"4f953lsZIFErKJ3FieNEEoj","AnimationManager",void 0);var T=c.ccclass,A=c.property;n("AnimationManager",(O=T("AnimationManager"),C=A(u),O((k=e((M=function(n){function e(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return e=n.call.apply(n,[this].concat(o))||this,i(e,"rotationContainer",k,a(e)),e.boardManager=null,e.tile=null,e.originalScale=new d(1,1,1),e.originalColor=p.WHITE.clone(),e.isAnimating=!1,e.selectionTween=null,e}t(e,n);var l=e.prototype;return l.onLoad=function(){this.boardManager=this.node.getComponent(v),this.tile=this.getComponent(b),this.tile?(this.originalScale.set(this.node.scale),this.tile.getSprite()&&this.originalColor.set(this.tile.getSprite().color)):console.error("AnimationManager requires a Tile component")},l.animateSwap=function(n,e,t){if(!(n.node&&e.node&&n.node.isValid&&e.node.isValid))throw new Error("Invalid tiles for swap animation");n.node.setSiblingIndex(e.node.parent.children.length),g(n.node).to(.11,{position:new d(e.node.x,e.node.y,n.node.position.z),scale:new d(1.85,1.85,1)},{easing:"linear"}).to(.1,{scale:new d(1,1,1)},{easing:"linear"}).start(),g(e.node).to(.2,{position:new d(n.node.x,n.node.y,e.node.position.z)},{easing:"linear"}).call((function(){t()})).start()},l.animateFall=function(){var n=o(r().mark((function n(e){var t,i,a,o,l,c,u,d,p,g,f,m,w,x,b,P,v,y=this;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.boardManager){n.next=2;break}throw new Error("BoardManager not set");case 2:for(t=e[0].tile.node.parent.children,i=s(t);!(a=i()).done;)o=a.value,h.stopAllByTarget(o),o.setScale(1,1,1);for(l=s(e);!(c=l()).done;)u=c.value,d=u.tile,p=u.fromY,g=u.toY,f=u.x,m=u.isNewTile,this.boardManager.getWorldPosition({x:f,y:g}),m?d.node.setScale(.8,.8,1):(w=this.boardManager.getWorldPosition({x:f,y:p}),d.node.setPosition(w.x,w.y,0));.1,x=[],b=r().mark((function n(){var e,t,i,a,o,s,l,c;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=v.value,t=e.tile,i=e.toY,a=e.x,o=e.isNewTile,s=e.fromY,l=y.boardManager.getWorldPosition({x:a,y:i}),c=new Promise((function(n){var e=o?.05*Math.abs(s):0,a=.1+.02*Math.abs(s-i),r=y.getTweenChain(t,l,o,e,a);r.call((function(){return n()})),r.start()})),x.push(c);case 5:case"end":return n.stop()}}),n)})),P=s(e);case 9:if((v=P()).done){n.next=13;break}return n.delegateYield(b(),"t0",11);case 11:n.next=9;break;case 13:return n.next=15,Promise.all(x);case 15:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),l.getTweenChain=function(n,e,t,i,a){var o=g(n.node).delay(i);return t?o.to(.1,{scale:new d(1,1,1)},{easing:"backOut"}).to(a,{position:new d(e.x,e.y,0)},{easing:"quartIn"}).to(.1,{scale:new d(1.05,.95,1)},{easing:"quadOut"}).to(.1,{scale:new d(1,1,1)},{easing:"backOut"}):o.to(a,{position:new d(e.x,e.y,0)},{easing:"quartIn"}).to(.1,{scale:new d(1.05,.95,1)},{easing:"quadOut"}).to(.1,{scale:new d(1,1,1)},{easing:"backOut"})},l.animateIdleTiles=function(){var n=o(r().mark((function n(e){var t,i,a,o,s,l,c,u;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=0;case 1:if(!(t<P.GridHeight)){n.next=8;break}for(i=0,a=t;i<=t&&a>=0;i++,a--)(o=e[a][i])&&o.onPlayerIdle();return n.next=5,new Promise((function(n){return setTimeout(n,50)}));case 5:t++,n.next=1;break;case 8:s=1;case 9:if(!(s<P.GridWidth)){n.next=16;break}for(l=s,c=P.GridHeight-1;l<P.GridWidth&&c>=0;l++,c--)(u=e[c][l])&&u.onPlayerIdle();return n.next=13,new Promise((function(n){return setTimeout(n,50)}));case 13:s++,n.next=9;break;case 16:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),l.animateMatchedTiles=function(n){},l.animateSelection=function(){if(!this.isAnimating){this.stopAllAnimations(),this.isAnimating=!0;var n=this.originalScale.clone().multiplyScalar(1.2);this.selectionTween=g(this.node).to(y.SELECTION_CONFIG.duration,{scale:n},{easing:"sineOut"}).to(y.SELECTION_CONFIG.duration,{scale:this.originalScale},{easing:"sineIn"}).union().repeatForever().start()}},l.animateDeselection=function(){this.isAnimating=!1,this.selectionTween&&(this.selectionTween.stop(),this.selectionTween=null),this.node.scale=this.originalScale},l.animateBounce=function(){var n=this;return new Promise((function(e){if(n.isAnimating)e();else{n.isAnimating=!0;var t=n.originalScale.clone().multiplyScalar(y.BOUNCE_CONFIG.scaleMultiplier);g(n.node).to(y.BOUNCE_CONFIG.duration,{scale:t},{easing:y.BOUNCE_CONFIG.easing}).to(y.BOUNCE_CONFIG.duration,{scale:n.originalScale},{easing:y.BOUNCE_CONFIG.easing}).call((function(){n.isAnimating=!1,e()})).start()}}))},l.animateMoveTo=function(n,e){var t=this,i=e||y.MOVEMENT_CONFIG.duration;return new Promise((function(e){g(t.node).to(i,{position:n},{easing:y.MOVEMENT_CONFIG.easing}).call((function(){e()})).start()}))},l.animatePulse=function(n){if(void 0===n&&(n=2),!this.isAnimating){this.isAnimating=!0;var e=this.originalScale.clone().multiplyScalar(y.PULSE_CONFIG.scaleMultiplier);g(this.node).to(y.PULSE_CONFIG.duration,{scale:e},{easing:y.PULSE_CONFIG.easing}).to(y.PULSE_CONFIG.duration,{scale:this.originalScale},{easing:y.PULSE_CONFIG.easing}).union().repeat(n).start()}},l.stopAllAnimations=function(){var n,e;this.isAnimating&&(g(this.node).stop(),null!=(n=this.tile)&&n.getSprite()&&g(this.tile.getSprite()).stop(),this.selectionTween&&(this.selectionTween.stop(),this.selectionTween=null),this.node.scale=this.originalScale,null!=(e=this.tile)&&e.getSprite()&&(this.tile.getSprite().color=this.originalColor),this.isAnimating=!1)},l.getIsAnimating=function(){return this.isAnimating},l.updateOriginalValues=function(){var n;this.originalScale.set(this.node.scale),null!=(n=this.tile)&&n.getSprite()&&this.originalColor.set(this.tile.getSprite().color)},l.animatePlayerIdle=function(){var n=this;this.isAnimating||(this.isAnimating=!0,g(this.node).to(.4,{scale:new d(1.15,1.15,1.15)},{easing:"sineOut"}).to(.4,{scale:new d(1,1,1)},{easing:"sineIn"}).union().call((function(){n.isAnimating=!1})).start())},l.animateDestroy=function(n,e){g(this.node).to(.1,{scale:new d(0,0,0)},{easing:"quadIn"}).call((function(){null==n||n(),null==e||e()})).start()},l.animateMilestoneCelebration=function(){var n=o(r().mark((function n(e,t,i){var a,o,s,l,c,u,p,f,h,w,x,b,v,y,S,O,C,I,M,k,T,A,E,N,G;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.boardManager){n.next=2;break}throw new Error("BoardManager not set");case 2:for(o=[],s=0;s<P.GridHeight;s++)for(l=0;l<P.GridWidth;l++)(c=e[s][l])&&c.node&&c.node.isValid&&o.push({tile:c,originalPos:c.node.position.clone(),originalParent:c.node.parent});if(0!==o.length){n.next=6;break}return n.abrupt("return");case 6:return u=o.length,p=P.MilestoneSystem.celebrationAnimationDuration,f=.1*p,h=.7*p,w=.2*p,x=t.position.clone(),b=P.GridWidth*P.TileWidth/2-P.TileWidth,v=P.GridHeight*P.TileHeight/2-P.TileHeight,y=1.1*Math.min(b,v),S=o.map((function(n,e){return new Promise((function(t){var i=e/u*Math.PI*2,a=x.x+Math.cos(i)*y,o=x.y+Math.sin(i)*y,r=e/u*.05;g(n.tile.node).delay(r).parallel(g(n.tile.node).to(f,{position:new d(a,o,0)},{easing:"quadOut"}),g(n.tile.node).to(.5*f,{scale:new d(.85,.85,1)},{easing:"quadOut"}).to(.5*f,{scale:new d(1,1,1)},{easing:"quadOut"})).call((function(){return t()})).start()}))})),n.next=18,Promise.all(S);case 18:for(O=m(this.rotationContainer),null==(a=t.parent)||a.addChild(O),O.setPosition(x),O.setSiblingIndex(this.rotationContainer.getSiblingIndex()),C=0,I=o;C<I.length;C++)M=I[C],k=M.tile.node.getWorldPosition(),M.tile.node.setParent(O),M.tile.node.setWorldPosition(k);return n.next=25,new Promise((function(n){g(O).to(h,{angle:-720},{easing:"sineInOut"}).call((function(){return n()})).start()}));case 25:for(T=0,A=o;T<A.length;T++)E=A[T],N=E.tile.node.getWorldPosition(),E.tile.node.setParent(E.originalParent),E.tile.node.setWorldPosition(N);return O.destroy(),G=o.map((function(n,e){return new Promise((function(t){var a=e/u*.1;g(n.tile.node).delay(a).parallel(g(n.tile.node).to(w,{position:n.originalPos},{easing:"backOut"}),g(n.tile.node).to(.2*w,{scale:new d(1.1,1.1,1)},{easing:"quadOut"}).to(.8*w,{scale:new d(1,1,1)},{easing:"bounceOut"})).call((function(){t(),null==i||i()})).start()}))})),n.next=30,Promise.all(G);case 30:case"end":return n.stop()}}),n,this)})));return function(e,t,i){return n.apply(this,arguments)}}(),l.animateDoubleRainbow=function(){var n=o(r().mark((function n(e,t,i){var a,o,s,l,c,u,p,f;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=(a=e.node)&&a.isValid&&null!=(o=t.node)&&o.isValid){n.next=2;break}return n.abrupt("return");case 2:if(this.node.getComponent(S),e.node.parent){n.next=6;break}return n.abrupt("return");case 6:return e.node.setSiblingIndex(t.node.parent.children.length),t.node.setSiblingIndex(e.node.parent.children.length),s=e.node.position.clone(),l=t.node.position.clone(),(c=s.clone().add(l).multiplyScalar(.5)).y+=120,u=function(n){return new Promise((function(e){g(n.node).to(.25,{position:new d(n.node.position.x,n.node.position.y+120,0),scale:new d(1.2,1.2,1)},{easing:"quadOut"}).to(.25,{position:c},{easing:"quadIn"}).call((function(){return e()})).start()}))},n.next=15,Promise.all([u(e),u(t)]);case 15:return n.next=17,new Promise((function(n){g(t.node).to(.2,{scale:new d(0,0,0)}).call((function(){return n()})).start()}));case 17:return n.next=19,new Promise((function(n){g(e.node).to(.2,{scale:new d(2.5,2.5,1)},{easing:"sineOut"}).call((function(){n()})).start()}));case 19:return p=function(n){return new Promise((function(e){g(n.node).to(.25,{position:new d(n.node.position.x,n.node.position.y+120,0)},{easing:"quadOut"}).call((function(){return e()})).start()}))},n.next=22,Promise.all([p(e),p(t)]);case 22:return f=function(n){return new Promise((function(e){var t=n.node.scale.clone();g(n.node).to(.25,{position:new d(l.x,l.y,0),scale:t.multiplyScalar(.85)},{easing:"quadOut"}).call((function(){return e()})).start()}))},n.next=25,Promise.all([f(e),f(t)]);case 25:case"end":return n.stop()}}),n,this)})));return function(e,t,i){return n.apply(this,arguments)}}(),l.animateRainbowClickEffect=function(){var n=o(r().mark((function n(e,t){var i,a,o;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=(i=e.node)&&i.isValid&&e.node.parent){n.next=2;break}return n.abrupt("return");case 2:e.node.setSiblingIndex(e.node.parent.children.length),a=e.node.position.clone(),o=e.node.scale.clone(),g(e.node).parallel(g(e.node).to(.2,{position:new d(a.x,a.y+60,0)},{easing:"backOut"}),g(e.node).to(.2,{scale:new d(1.5*o.x,1.5*o.y,1)},{easing:"backOut"})).parallel(g(e.node).to(.2,{position:a},{easing:"backIn"}),g(e.node).to(.2,{scale:new d(.5*o.x,.5*o.y,1)},{easing:"backIn"})).delay(.1).call((function(){null==t||t()})).start();case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),l.animateRainbowSwapToType=function(){var n=o(r().mark((function n(e,t,i){var a,o,s,l,c,p,f,h,m,b,v,y;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=(a=e.node)&&a.isValid&&e.node.parent){n.next=2;break}return n.abrupt("return");case 2:if(i.length){n.next=4;break}return n.abrupt("return");case 4:for(o=i.length,s=[],l=e.node.position.clone(),c=0;c<o;c++)(p=new u("RainbowPiece_"+c)).addComponent(w),f=p.getComponent(w),(h=p.addComponent(x))&&h.setContentSize(P.SpriteSize,P.SpriteSize),(m=e.getSprite())&&m.spriteFrame&&(f.spriteFrame=m.spriteFrame),p.setParent(e.node.parent),p.setPosition(l),p.setScale(.5,.5,1),s.push(p);return g(e.node).to(.2,{scale:new d(0,0,1)},{easing:"backIn"}).start(),b=s.map((function(n,e){var t=e/o*360+60*Math.random()-30,i=80+40*Math.random(),a=Math.cos(t*Math.PI/180)*i,r=Math.sin(t*Math.PI/180)*i;return new Promise((function(e){g(n).to(.3,{position:new d(l.x+a,l.y+r,0),scale:new d(.6,.6,1)},{easing:"backOut"}).call((function(){return e()})).start()}))})),n.next=12,Promise.all(b);case 12:return n.next=14,new Promise((function(n){return setTimeout(n,200)}));case 14:return v=s.map((function(n,e){var t,a=i[e];if(null==(t=a.node)||!t.isValid)return Promise.resolve();var o=a.node.position.clone(),r=.07*e;return new Promise((function(e){g(n).delay(r).to(.5,{position:o,scale:new d(.2,.2,1)},{easing:"quadInOut"}).call((function(){var t;null!=(t=a.node)&&t.isValid&&g(a.node).to(.1,{scale:new d(1.3,1.3,1)},{easing:"backOut"}).to(.2,{scale:new d(0,0,1)},{easing:"backIn"}).start(),n.destroy(),e()})).start()}))})),n.next=17,Promise.all(v);case 17:(y=this.node.getComponent(S))&&e.node.parent&&y.playSparkleEffect(l,e.node.parent);case 19:case"end":return n.stop()}}),n,this)})));return function(e,t,i){return n.apply(this,arguments)}}(),l.animateCombine=function(){var n=o(r().mark((function n(e,t,i,a){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:g(e.node).to(.1,{position:t.node.getPosition()},{easing:"quadOut"}).call((function(){null==i||i(),null==a||a()})).start();case 1:case"end":return n.stop()}}),n)})));return function(e,t,i,a){return n.apply(this,arguments)}}(),e}(f)).prototype,"rotationContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=M))||I));l._RF.pop()}}}));

System.register("chunks:///_virtual/AssetLoader.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var e,o,t,s,a,i,n,c,p,u,l;return{setters:[function(r){e=r.applyDecoratedDescriptor,o=r.inheritsLoose,t=r.initializerDefineProperty,s=r.assertThisInitialized},function(r){a=r.cclegacy,i=r._decorator,n=r.ProgressBar,c=r.director,p=r.resources,u=r.SpriteFrame,l=r.Component}],execute:function(){var d,f,g,h,B;a._RF.push({},"ff792SUt8BAQoHTgLc+DQEW","AssetLoader",void 0);var m=i.ccclass,y=i.property;r("AssetLoader",(d=m("AssetLoader"),f=y(n),d((B=e((h=function(r){function e(){for(var e,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return e=r.call.apply(r,[this].concat(a))||this,t(e,"progressBar",B,s(e)),e}o(e,r);var a=e.prototype;return a.__preload=function(){if(!this.progressBar)throw new Error("ProgressBar is required");c.preloadScene("GameScene"),p.preloadDir("images")},a.start=function(){var r=this;p.loadDir("images",u,(function(e,o){r.updateProgressBar(e/o)}),(function(e){e?console.error(e):(r.updateProgressBar(1),r.switchToGameScene())}))},a.updateProgressBar=function(r){this.progressBar.progress=r},a.switchToGameScene=function(){c.loadScene("GameScene")},e}(l)).prototype,"progressBar",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=h))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts"],(function(i){var e,t,u,o,n,c,a,s,r;return{setters:[function(i){e=i.applyDecoratedDescriptor,t=i.inheritsLoose,u=i.initializerDefineProperty,o=i.assertThisInitialized},function(i){n=i.cclegacy,c=i._decorator,a=i.AudioSource,s=i.AudioClip},function(i){r=i.Singleton}],execute:function(){var l,p,f,E,S,h,m,T,d,C,M,A;n._RF.push({},"1c175HCoxtFJL8HIFJzDgR0","AudioManager",void 0);var I=c.ccclass,y=c.property,L=i("AudioType",function(i){return i[i.BACKGROUND_MUSIC=0]="BACKGROUND_MUSIC",i[i.TILE_MATCH=1]="TILE_MATCH",i[i.TILE_SWAP=2]="TILE_SWAP",i[i.TILE_SELECT=3]="TILE_SELECT",i[i.SPECIAL_TILE_CREATED=4]="SPECIAL_TILE_CREATED",i[i.SPECIAL_TILE_ACTIVATED=5]="SPECIAL_TILE_ACTIVATED",i[i.MILESTONE_COMPLETED=6]="MILESTONE_COMPLETED",i[i.BUTTON_CLICK=7]="BUTTON_CLICK",i[i.GAME_OVER=8]="GAME_OVER",i[i.RAINBOW_SPECIAL=9]="RAINBOW_SPECIAL",i}({}));i("AudioManager",(l=I("AudioManager"),p=y(a),f=y(a),E=y([s]),l((m=e((h=function(i){function e(){for(var e,t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return e=i.call.apply(i,[this].concat(n))||this,u(e,"musicSource",m,o(e)),u(e,"effectSource",T,o(e)),u(e,"audioClips",d,o(e)),u(e,"audioVolume",C,o(e)),u(e,"musicVolume",M,o(e)),u(e,"isMuted",A,o(e)),e.audioMap=new Map,e}t(e,i);var n=e.prototype;return n.onLoad=function(){this.initializeAudioMap()},n.initializeAudioMap=function(){for(var i=0;i<this.audioClips.length;i++)i<Object.keys(L).length/2&&this.audioMap.set(i,this.audioClips[i])},n.playMusic=function(i,e){if(void 0===i&&(i=L.BACKGROUND_MUSIC),void 0===e&&(e=!0),!this.isMuted&&this.musicSource){var t=this.audioMap.get(i);t&&(this.musicSource.clip=t,this.musicSource.loop=e,this.musicSource.volume=this.musicVolume,this.musicSource.play())}},n.playEffect=function(i,e){if(void 0===e&&(e=1),!this.isMuted&&this.effectSource){var t=this.audioMap.get(i);t&&this.effectSource.playOneShot(t,e*this.audioVolume)}},n.stopMusic=function(){this.musicSource&&this.musicSource.stop()},n.pauseMusic=function(){this.musicSource&&this.musicSource.pause()},n.resumeMusic=function(){this.musicSource&&!this.isMuted&&this.musicSource.play()},n.setMute=function(i){this.isMuted=i,this.musicSource&&(i?this.musicSource.pause():this.musicSource.play())},n.setMusicVolume=function(i){this.musicVolume=Math.max(0,Math.min(1,i)),this.musicSource&&(this.musicSource.volume=this.musicVolume)},n.setEffectsVolume=function(i){this.audioVolume=Math.max(0,Math.min(1,i))},n.playTileMatchSound=function(){this.playEffect(L.TILE_MATCH)},n.playTileSwapSound=function(){this.playEffect(L.TILE_SWAP)},n.playTileSelectSound=function(){this.playEffect(L.TILE_SELECT)},n.playSpecialTileCreatedSound=function(){this.playEffect(L.SPECIAL_TILE_CREATED)},n.playSpecialTileActivatedSound=function(){this.playEffect(L.SPECIAL_TILE_ACTIVATED)},n.playMilestoneCompletedSound=function(){this.playEffect(L.MILESTONE_COMPLETED)},n.playButtonClickSound=function(){this.playEffect(L.BUTTON_CLICK)},n.playGameOverSound=function(){this.playEffect(L.GAME_OVER)},n.playRainbowSpecialSound=function(){this.playEffect(L.RAINBOW_SPECIAL)},e}(r)).prototype,"musicSource",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(h.prototype,"effectSource",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=e(h.prototype,"audioClips",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),C=e(h.prototype,"audioVolume",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),M=e(h.prototype,"musicVolume",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),A=e(h.prototype,"isMuted",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=h))||S));n._RF.pop()}}}));

System.register("chunks:///_virtual/BoardManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./Tile.ts","./Frame.ts","./GameGlobalData.ts"],(function(t){var i,e,r,n,a,l,o,s,h,d,u,f,c,G;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){a=t.cclegacy,l=t._decorator,o=t.Prefab,s=t.instantiate,h=t.Button,d=t.Component},function(t){u=t.GameConfig},function(t){f=t.Tile},function(t){c=t.Frame},function(t){G=t.GameGlobalData}],execute:function(){var g,T,v,m,p,y,b;a._RF.push({},"76c733eZfpJ+bMWRYNX9PiB","BoardManager",void 0);var A=l.ccclass,P=l.property;t("BoardManager",(g=A("BoardManager"),T=P(o),v=P(o),g((y=i((p=function(t){function i(){for(var i,e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];return i=t.call.apply(t,[this].concat(a))||this,r(i,"tilePrefab",y,n(i)),r(i,"framePrefab",b,n(i)),i.tileGrid=[],i.frameGrid=[],i.virtualGrid=[],i.tileCoords=new Map,i.maxDifference=4,i.VIRTUAL_GRID_HEIGHT=u.GridHeight,i}e(i,t);var a=i.prototype;return a.__preload=function(){if(null===this.tilePrefab)throw new Error("Tile prefab is not set");if(null===this.framePrefab)throw new Error("Frame prefab is not set")},a.setTilePrefab=function(t){this.tilePrefab=t},a.setFramePrefab=function(t){this.framePrefab=t},a.createFrames=function(){this.frameGrid=[];for(var t=0;t<u.GridHeight;t++){this.frameGrid[t]=[];for(var i=0;i<u.GridWidth;i++)this.frameGrid[t][i]=this.createFrame(i,t)}},a.initializeBoard=function(){this.createTiles(),this.initializeVirtualGrid()},a.getTileGrid=function(){return this.tileGrid},a.getFrameGrid=function(){return this.frameGrid},a.getVirtualGrid=function(){return this.virtualGrid},a.getVirtualGridHeight=function(){return this.VIRTUAL_GRID_HEIGHT},a.getTileCoords=function(){return this.tileCoords},a.getTileAt=function(t,i){if(i>=0&&i<this.tileGrid.length&&t>=0&&t<this.tileGrid[i].length)return this.tileGrid[i][t]},a.getVirtualTileAt=function(t,i){if(i>=0&&i<this.virtualGrid.length&&t>=0&&t<this.virtualGrid[i].length)return this.virtualGrid[i][t]},a.setTileAt=function(t,i,e){i>=0&&i<this.tileGrid.length&&t>=0&&t<this.tileGrid[i].length&&(this.tileGrid[i][t]=e,e&&this.tileCoords.set(e,{x:t,y:i}))},a.setVirtualTileAt=function(t,i,e){i>=0&&i<this.virtualGrid.length&&t>=0&&t<this.virtualGrid[i].length&&(this.virtualGrid[i][t]=e,e&&this.tileCoords.set(e,{x:t,y:-(i+1)}))},a.getWorldPosition=function(t){return{x:-u.GridWidth*u.TileWidth/2+u.TileWidth/2+t.x*u.TileWidth+u.OffsetX,y:-(-u.GridHeight*u.TileHeight/2+u.TileHeight/2+t.y*u.TileHeight+u.OffsetY)}},a.getVirtualWorldPosition=function(t){return{x:-u.GridWidth*u.TileWidth/2+u.TileWidth/2+t.x*u.TileWidth,y:-(-u.GridHeight*u.TileHeight/2+u.TileHeight/2+(-t.y-this.VIRTUAL_GRID_HEIGHT)*u.TileHeight)}},a.getNeighbors=function(t){var i=[],e=t.x,r=t.y;return e>0&&this.getTileAt(e-1,r)&&i.push(this.getTileAt(e-1,r)),e<u.GridWidth-1&&this.getTileAt(e+1,r)&&i.push(this.getTileAt(e+1,r)),r>0&&this.getTileAt(e,r-1)&&i.push(this.getTileAt(e,r-1)),r<u.GridHeight-1&&this.getTileAt(e,r+1)&&i.push(this.getTileAt(e,r+1)),i},a.createTileAt=function(t,i){var e,r=u.CandyTypes[Math.floor(Math.random()*Math.min(this.maxDifference,u.CandyTypes.length))],n=s(this.tilePrefab);if(null===n)throw new Error("Failed to instantiate tile prefab");var a=n.getComponent(f);if(null===a)throw new Error("Failed to get tile component");null==(e=this.node)||e.addChild(n),a.setTileType(r);var l=this.getWorldPosition({x:t,y:i}),o=l.x,h=l.y;n.setPosition(o,h);var d=this.frameGrid[i][t];return d&&a.setFrame(d),this.tileCoords.set(a,{x:t,y:i}),this.tileGrid[i][t]=a,a},a.createVirtualTileAt=function(t,i){var e,r=u.CandyTypes[Math.floor(Math.random()*Math.min(this.maxDifference,u.CandyTypes.length))],n=s(this.tilePrefab);if(null===n)throw new Error("Failed to instantiate tile prefab");var a=n.getComponent(f);if(null===a)throw new Error("Failed to get tile component");null==(e=this.node)||e.addChild(n),a.setTileType(r);var l=this.getVirtualWorldPosition({x:t,y:i}),o=l.x,h=l.y;return n.setPosition(o,h),n.active=!1,this.tileCoords.set(a,{x:t,y:-(i+1)}),this.virtualGrid[i][t]=a,a},a.moveVirtualTileToMainGrid=function(t,i,e,r){var n=this.getVirtualTileAt(t,i);if(!n)return null;this.setVirtualTileAt(t,i,void 0),this.setTileAt(e,r,n);var a=this.frameGrid[r][e];return a&&n.setFrame(a),n},a.getVirtualTilesForColumn=function(t,i){for(var e=[],r=0,n=this.VIRTUAL_GRID_HEIGHT-1;n>=0&&r<i;n--){var a=this.getVirtualTileAt(t,n);if(a){a.node.active=!0;var l=a.node.getComponent(h);l&&(l.interactable=!G.getInstance().getIsGamePaused());var o=-(r+1),s=this.getWorldPosition({x:t,y:o});a.node.setPosition(s.x,s.y,0),e.push(a),this.setVirtualTileAt(t,n,void 0),r++}}return e},a.refillVirtualGrid=function(){for(var t=0;t<u.GridWidth;t++)for(var i=0;i<this.VIRTUAL_GRID_HEIGHT;i++){if(!this.getVirtualTileAt(t,i))this.createVirtualTileAt(t,i).node.active=!1}},a.clearTileAt=function(t,i){var e=this.tileGrid[i][t];e&&(this.tileCoords.delete(e),this.tileGrid[i][t]=void 0)},a.initializeVirtualGrid=function(){this.virtualGrid=[];for(var t=0;t<this.VIRTUAL_GRID_HEIGHT;t++){this.virtualGrid[t]=[];for(var i=0;i<u.GridWidth;i++)this.virtualGrid[t][i]=this.createVirtualTileAt(i,t)}},a.createTiles=function(){this.tileGrid=[];for(var t=0;t<u.GridHeight;t++){this.tileGrid[t]=[];for(var i=0;i<u.GridWidth;i++)this.tileGrid[t][i]=this.createTileAt(i,t)}},a.createFrame=function(t,i){var e,r=s(this.framePrefab);if(null===r)throw new Error("Failed to instantiate frame prefab");var n=r.getComponent(c);if(null===n)throw new Error("Failed to get Frame component");var a=this.getWorldPosition({x:t,y:i}),l=a.x,o=a.y;return r.setPosition(l,o),n.setSpriteFrame((t+i)%2),null==(e=this.node)||e.addChild(r),n.setTweenDuration(.15),n},i}(d)).prototype,"tilePrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=i(p.prototype,"framePrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=p))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/ConfettiParticle.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,e,s,a,n,r,o,c,l,h,y,u,f,p;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,s=i.initializerDefineProperty,a=i.assertThisInitialized,n=i.extends},function(i){r=i.cclegacy,o=i._decorator,c=i.Sprite,l=i.Vec3,h=i.Color,y=i.randomRange,u=i.randomRangeInt,f=i.UITransform,p=i.Component}],execute:function(){var v,m,d,g,S;r._RF.push({},"b39e7Gz7RlOwqyl4LsJsGi7","ConfettiParticle",void 0);var E=o.ccclass,P=o.property;i("ConfettiParticle",(v=E("ConfettiParticle"),m=P(c),v((S=t((g=function(i){function t(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=i.call.apply(i,[this].concat(n))||this,s(t,"sprite",S,a(t)),t.velocity=new l,t.angularVelocity=0,t.gravity=9.81,t.airDensity=1.225,t.mass=.001,t.dragCoefficient=1.2,t.crossSectionalArea=1e-4,t.terminalVelocity=0,t.lifetime=0,t.maxLifetime=5,t.startTime=0,t.PIXELS_PER_METER=200,t.GRAVITY_PIXELS=981,t.initialScale=new l(1,1,1),t.fadeStartTime=.7,t.currentShape="rectangle",t.isActive=!1,t.destroyCallback=null,t}e(t,i);var r=t.prototype;return r.setVelocity=function(i){this.velocity=i},r.onLoad=function(){this.sprite||(this.sprite=this.getComponent(c)||this.addComponent(c)),this.initialScale=this.node.scale.clone(),this.node.active=!1},r.launch=function(i){void 0===i&&(i={}),this.setupParticle(i),this.isActive=!0,this.startTime=Date.now()/1e3,this.node.active=!0},r.setupParticle=function(i){var t={initialVelocityMin:new l(-40,400,0),initialVelocityMax:new l(40,500,0),gravity:this.GRAVITY_PIXELS,airDensity:1.225,rotationSpeed:360,lifetime:5,colors:[new h(255,215,0),new h(255,20,147),new h(0,191,255),new h(50,205,50),new h(255,165,0),new h(138,43,226),new h(255,69,0),new h(255,105,180)],shapes:["rectangle","square"],massRange:{min:.0015,max:.002}},e=n({},t,i);this.velocity=new l(y(e.initialVelocityMin.x,e.initialVelocityMax.x),y(e.initialVelocityMin.y,e.initialVelocityMax.y),0),this.gravity=e.gravity,this.airDensity=e.airDensity,this.maxLifetime=e.lifetime,this.mass=y(e.massRange.min,e.massRange.max),this.angularVelocity=y(-e.rotationSpeed,e.rotationSpeed);var s=e.colors[u(0,e.colors.length)];this.sprite&&(this.sprite.color=s);var a=y(.5,1.2);this.node.setScale(this.initialScale.x*a,this.initialScale.y*a,this.initialScale.z),this.currentShape=e.shapes[u(0,e.shapes.length)],this.createConfettiShape(this.currentShape),this.calculateTerminalVelocity()},r.createConfettiShape=function(i){var t=this.node.getComponent(f);if(t){var e,s;switch(i){case"rectangle":e=15,s=10,this.dragCoefficient=.98;break;case"square":e=s=12,this.dragCoefficient=1.05}t.setContentSize(e,s);var a=e/this.PIXELS_PER_METER,n=s/this.PIXELS_PER_METER;this.crossSectionalArea=a*n}},r.calculateTerminalVelocity=function(){var i=9.81*this.mass,t=this.dragCoefficient*this.airDensity*this.crossSectionalArea,e=Math.sqrt(2*i/t);this.terminalVelocity=e*this.PIXELS_PER_METER},r.calculateDragForce=function(i){var t=i.length();if(0===t||!isFinite(t))return new l(0,0,0);var e=t/this.PIXELS_PER_METER,s=.5*this.dragCoefficient*this.airDensity*this.crossSectionalArea*e*e*this.PIXELS_PER_METER/this.mass;if(!isFinite(s)||s>1e4)return new l(0,0,0);var a=i.clone().normalize();return a.multiplyScalar(-s),a},r.update=function(i){this.isActive&&(this.updatePhysics(i),this.updateLifetime(i),this.updateAppearance())},r.updatePhysics=function(i){var t=new l(0,-this.gravity,0),e=this.calculateDragForce(this.velocity),s=t.add(e);isFinite(s.x)&&isFinite(s.y)||s.set(0,-this.gravity,0),this.velocity.length()>1.1*-this.terminalVelocity&&(this.velocity.x+=s.x*i,this.velocity.y+=s.y*i),isFinite(this.velocity.x)&&isFinite(this.velocity.y)||this.velocity.set(0,0,0);var a=this.node.position,n=a.x+this.velocity.x*i,r=a.y+this.velocity.y*i;isFinite(n)&&isFinite(r)&&this.node.setPosition(n,r,a.z);var o=this.node.eulerAngles;this.node.setRotationFromEuler(o.x,o.y,o.z+this.angularVelocity*i)},r.updateLifetime=function(i){this.lifetime+=i,this.lifetime>=this.maxLifetime&&this.destroyParticle()},r.updateAppearance=function(){var i=this.lifetime/this.maxLifetime;if(i>this.fadeStartTime){var t=(i-this.fadeStartTime)/(1-this.fadeStartTime),e=Math.max(0,1-t);if(this.sprite){var s=this.sprite.color.clone();s.a=255*e,this.sprite.color=s}}var a=1-.2*i;this.node.setScale(this.initialScale.x*a,this.initialScale.y*a,this.initialScale.z)},r.setDestroyCallback=function(i){this.destroyCallback=i},r.destroyParticle=function(){this.isActive=!1,this.destroyCallback&&this.destroyCallback(),this.node.active=!1},r.getIsActive=function(){return this.isActive},r.getVelocity=function(){return this.velocity.clone()},r.getTerminalVelocity=function(){return this.terminalVelocity},r.getSpeedRatio=function(){return this.velocity.length()/this.terminalVelocity},r.stop=function(){this.isActive=!1,this.velocity.set(0,0,0),this.angularVelocity=0},t}(p)).prototype,"sprite",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=g))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/ConfettiSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfettiParticle.ts"],(function(t){var e,n,i,r,o,a,c,s,l,u,f,h,v,p,d,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.extends,a=t.createForOfIteratorHelperLoose},function(t){c=t.cclegacy,s=t._decorator,l=t.Prefab,u=t.instantiate,f=t.Color,h=t.Vec3,v=t.randomRange,p=t.UITransform,d=t.Component},function(t){P=t.ConfettiParticle}],execute:function(){var g,y,C,w,m;c._RF.push({},"85bf3haFSxHrZPfnOATqnhI","ConfettiSystem",void 0);var b=s.ccclass,S=s.property;t("ConfettiSystem",(g=b("ConfettiSystem"),y=S(l),g((m=e((w=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"confettiParticlePrefab",m,r(e)),e.activeParticles=[],e}n(e,t);var c=e.prototype;return c.createParticleNode=function(){var t=u(this.confettiParticlePrefab);return this.node.addChild(t),t},c.spawnConfettiParticle=function(t,e){var n=this;void 0===e&&(e={});var i=this.createParticleNode();i.active=!0;var r=i.getComponent(P);return r?(i.setPosition(t),r.setDestroyCallback((function(){n.removeActiveParticle(r)})),r.launch(e),this.activeParticles.push(r),r):(console.error("ConfettiParticle component not found on particle node"),null)},c.createConfettiBurst=function(t,e){var n=this;void 0===e&&(e={});for(var i={particleCount:35,spawnRadius:100,burstDuration:0,colors:[new f(255,215,0),new f(255,20,147),new f(0,191,255),new f(50,205,50),new f(255,165,0),new f(138,43,226)],intensity:"heavy"},r=o({},i,e),a=this.getParticleCount(r),c=r.burstDuration/a,s=0;s<a;s++)this.scheduleOnce((function(){var e=.3*r.spawnRadius,i=n.getRandomSpawnPosition(t,e),o=n.getParticleConfig(r);n.spawnConfettiParticle(i,o)}),s*c)},c.getParticleCount=function(t){switch(t.intensity){case"light":return Math.floor(.5*t.particleCount);case"heavy":return Math.floor(1.5*t.particleCount);default:return t.particleCount}},c.createCelebrationConfetti=function(){for(var t,e=this,n=this.getScreenBounds(),i=[new h(n.left+100,n.top-100,0),new h(n.right-100,n.top-100,0),new h(n.center.x,n.top-50,0),new h(n.left+200,n.top-200,0),new h(n.right-200,n.top-200,0)],r=function(){var n=t.value,i=n[0],r=n[1];e.scheduleOnce((function(){e.createConfettiBurst(r,{particleCount:40,intensity:"medium"})}),.1*i)},o=a(i.entries());!(t=o()).done;)r()},c.getParticleConfig=function(t){var e="heavy"===t.intensity?1.2:"light"===t.intensity?.8:1,n=500*e,i=300*e;return{initialVelocityMin:new h(-i,200*e,0),initialVelocityMax:new h(i,n,0),colors:t.colors,lifetime:"heavy"===t.intensity?7:6,gravity:600,airDensity:1.5,shapes:["square","rectangle"],massRange:{min:5e-4,max:.0015},rotationSpeed:540}},c.getRandomSpawnPosition=function(t,e){var n=v(0,2*Math.PI),i=v(0,e);return new h(t.x+Math.cos(n)*i,t.y+Math.sin(n)*i,t.z)},c.getScreenBounds=function(){try{var t=this.node.getComponent(p);if(t&&t.contentSize){var e=t.contentSize;return{left:-e.width/2,right:e.width/2,top:e.height/2,bottom:-e.height/2,center:{x:0,y:0}}}}catch(t){console.warn("Could not get screen bounds, using defaults:",t)}return{left:-400,right:400,top:300,bottom:-300,center:{x:0,y:0}}},c.removeActiveParticle=function(t){var e=this.activeParticles.indexOf(t);e>-1&&this.activeParticles.splice(e,1)},c.clearAllParticles=function(){for(var t,e=a(this.activeParticles);!(t=e()).done;){var n=t.value;n&&n.getIsActive()&&n.destroyParticle()}this.activeParticles=[]},c.getActiveParticleCount=function(){return this.activeParticles.length},c.onDestroy=function(){this.clearAllParticles()},e}(d)).prototype,"confettiParticlePrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=w))||C));c._RF.pop()}}}));

System.register("chunks:///_virtual/Frame.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts"],(function(i){var t,e,r,s,o,n,a,p,h,l,c,u;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,r=i.initializerDefineProperty,s=i.assertThisInitialized},function(i){o=i.cclegacy,n=i._decorator,a=i.Sprite,p=i.SpriteFrame,h=i.UITransform,l=i.tween,c=i.Component},function(i){u=i.GameConfig}],execute:function(){var g,f,m,v,F,A,b;o._RF.push({},"6a8c2mjIgVAtJADtmbpcPpA","Frame",void 0);var w=n.ccclass,y=n.property;i("Frame",(g=w("Frame"),f=y(a),m=y([p]),g((A=t((F=function(i){function t(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t=i.call.apply(i,[this].concat(o))||this,r(t,"sprite",A,s(t)),r(t,"spriteFrames",b,s(t)),t.originalAlpha=.6,t.hoverAlpha=.7,t.isHovering=!1,t.tweenDuration=.15,t}e(t,i);var o=t.prototype;return o.__preload=function(){if(!this.sprite)throw new Error("Sprite is required for Frame")},o.onLoad=function(){if(!this.sprite)throw new Error("Sprite is required for Frame");var i=this.sprite.color.clone();this.sprite.color=i.set(i.r,i.g,i.b,255*this.originalAlpha)},o.setSpriteFrame=function(i){if(!(!this.sprite||!this.spriteFrames||i<0||i>=this.spriteFrames.length)){this.sprite.spriteFrame=this.spriteFrames[i];var t=this.sprite.node.getComponent(h);t&&t.setContentSize(u.FrameSize,u.FrameSize)}},o.triggerMouseEnter=function(){if(!this.isHovering&&this.sprite){this.isHovering=!0;var i=this.sprite.color.clone();this.sprite.color=i.set(i.r,i.g,i.b,255*this.hoverAlpha)}},o.triggerMouseLeave=function(){if(this.isHovering&&this.sprite){this.isHovering=!1;var i=this.sprite.color.clone();this.sprite.color=i.set(i.r,i.g,i.b,255*this.originalAlpha)}},o.setHoverState=function(i){i?this.triggerMouseEnter():this.triggerMouseLeave()},o.setHoverAlpha=function(i){this.hoverAlpha=Math.max(0,Math.min(1,i))},o.setOriginalAlpha=function(i){this.originalAlpha=Math.max(0,Math.min(1,i))},o.setTweenDuration=function(i){this.tweenDuration=Math.max(.05,i)},o.getIsHovering=function(){return this.isHovering},o.resetFrame=function(){if(this.sprite){l(this.sprite).stop();var i=this.sprite.color.clone();this.sprite.color=i.set(i.r,i.g,i.b,255*this.originalAlpha),this.isHovering=!1}},o.onDestroy=function(){this.sprite&&l(this.sprite).stop()},t}(c)).prototype,"sprite",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(F.prototype,"spriteFrames",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=F))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/GameConfig.ts",["cc"],(function(e){var n,w,a;return{setters:[function(e){n=e.cclegacy,w=e.Vec3,a=e.Color}],execute:function(){n._RF.push({},"066a2a7XoVHzJHXDKi1vGjH","GameConfig",void 0);e("PatternShape",[{name:"HorizontalLine5",shape:[new w(0,0),new w(1,0),new w(2,0),new w(3,0),new w(4,0)]},{name:"VerticalLine5",shape:[new w(0,0),new w(0,1),new w(0,2),new w(0,3),new w(0,4)]},{name:"PlusShape",shape:[new w(0,0),new w(1,0),new w(0,1),new w(0,-1),new w(-1,0)]},{name:"LShapeLeft",shape:[new w(0,0),new w(0,1),new w(0,2),new w(-1,0),new w(-2,0)]},{name:"LShapeRight",shape:[new w(0,0),new w(0,1),new w(0,2),new w(1,0),new w(2,0)]},{name:"LShapeUp",shape:[new w(0,0),new w(0,-1),new w(0,-2),new w(1,0),new w(2,0)]},{name:"LShapeDown",shape:[new w(0,0),new w(0,-1),new w(0,-2),new w(-1,0),new w(-2,0)]},{name:"TShapeUp",shape:[new w(0,0),new w(-1,0),new w(1,0),new w(0,1),new w(0,2)]},{name:"TShapeDown",shape:[new w(0,0),new w(-1,0),new w(1,0),new w(0,-1),new w(0,-2)]},{name:"TShapeLeft",shape:[new w(0,0),new w(0,1),new w(0,-1),new w(-1,0),new w(-2,0)]},{name:"TShapeRight",shape:[new w(0,0),new w(0,1),new w(0,-1),new w(1,0),new w(2,0)]},{name:"HorizontalLine4",shape:[new w(0,0),new w(1,0),new w(2,0),new w(3,0)]},{name:"VerticalLine4",shape:[new w(0,0),new w(0,1),new w(0,2),new w(0,3)]},{name:"HorizontalLine3",shape:[new w(0,0),new w(1,0),new w(2,0)]},{name:"VerticalLine3",shape:[new w(0,0),new w(0,1),new w(0,2)]}]),e("GameConfig",{GridWidth:8,GridHeight:8,TileWidth:80,TileHeight:80,SpriteSize:74,FrameSize:76,OffsetX:0,OffsetY:40,MaxIdleTime:10,HintTime:20,Moves:10,MilestoneSystem:{milestoneThresholds:[2e3,4500,7500,11e3,15e3,2e4,25e3,3e4,35e3,4e4,45e3,5e4,55e3,6e4,65e3,7e4,75e3,8e4,85e3,9e4,95e3,1e5],movePerMilestone:[10,20,30,40,50,60,70,80,90,100],pointsPerTile:10,bonusPoints:{match4:50,match5Plus:100},celebrationAnimationDuration:6},RainbowClick:{minDestroyCount:6,maxDestroyCount:20},CandyTypes:[{name:"Blue Candy",color:new a(55,78,252,255)},{name:"Green Candy",color:new a(0,128,0,255)},{name:"Red Candy",color:new a(255,0,0,255)},{name:"Purple Candy",color:new a(128,0,128,255)},{name:"Yellow Candy",color:new a(255,255,0,255)},{name:"Orange Candy",color:new a(255,126,25,255)}]});n._RF.pop()}}}));

System.register("chunks:///_virtual/GameGlobalData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts"],(function(e){var t,s,n;return{setters:[function(e){t=e.inheritsLoose},function(e){s=e.cclegacy},function(e){n=e.Singleton}],execute:function(){s._RF.push({},"65b77HWEHtHDpqHoObcPmcf","GameGlobalData",void 0);e("GameGlobalData",function(e){function s(){for(var t,s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).isMouseDown=!1,t.isGamePaused=!1,t.isGameOver=!1,t}t(s,e);var n=s.prototype;return n.getIsMouseDown=function(){return this.isMouseDown},n.setIsMouseDown=function(e){this.isMouseDown=e},n.getIsGamePaused=function(){return this.isGamePaused},n.setIsGamePaused=function(e){this.isGamePaused=e},n.getIsGameOver=function(){return this.isGameOver},n.setIsGameOver=function(e){this.isGameOver=e},s}(n));s._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./GameGlobalData.ts","./BoardManager.ts","./MatchManager.ts","./AnimationManager.ts","./InputManager.ts","./ProgressManager.ts","./SpecialTileManager.ts","./ParticleEffectManager.ts","./Singleton.ts","./SpecialTileConfig.ts","./MilestoneAchievementUI.ts","./PausePopup.ts","./GameOverPopup.ts","./ProgressUI.ts","./ConfettiSystem.ts"],(function(e){var t,n,i,a,r,s,o,l,u,c,h,d,p,f,g,v,m,b,M,T,w,x,y,S,I,k,G,P,C,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.asyncToGenerator,s=e.createForOfIteratorHelperLoose,o=e.regeneratorRuntime},function(e){l=e.cclegacy,u=e._decorator,c=e.Camera,h=e.Node,d=e.Button,p=e.tween,f=e.Vec3},function(e){g=e.GameConfig},function(e){v=e.GameGlobalData},function(e){m=e.BoardManager},function(e){b=e.MatchManager},function(e){M=e.AnimationManager},function(e){T=e.InputManager},function(e){w=e.ProgressManager},function(e){x=e.SpecialTileManager},function(e){y=e.ParticleEffectManager},function(e){S=e.Singleton},function(e){I=e.SpecialTileType},function(e){k=e.MilestoneAchievementUI},function(e){G=e.PausePopup},function(e){P=e.GameOverPopup},function(e){C=e.ProgressUI},function(e){B=e.ConfettiSystem}],execute:function(){var E,O,A,D,R,U,H,F,N,W,_,V,z,q,Y,L,j,J,K;l._RF.push({},"cb6b24lA09FMol6Lsdq977r","GameManager",void 0);var Q=u.ccclass,X=u.property;e("default",(E=Q("GameManager"),O=X(c),A=X(h),D=X(h),R=X(h),U=X(G),H=X(P),F=X(d),N=X(B),E((V=t((_=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,i(t,"camera",V,a(t)),i(t,"celebrationNode",z,a(t)),i(t,"milestoneUINode",q,a(t)),i(t,"progressUINode",Y,a(t)),i(t,"pausePopupUI",L,a(t)),i(t,"gameOverPopup",j,a(t)),i(t,"pauseButton",J,a(t)),i(t,"confettiSystem",K,a(t)),t.boardManager=null,t.matchManager=null,t.animationManager=null,t.inputManager=null,t.specialTileManager=null,t.particleEffectManager=null,t.milestoneAchievementUI=null,t.pausePopup=null,t.progressUI=null,t.playerIdleTimeForHint=0,t.playerIdleTimeForMaxIdle=0,t.canMove=!1,t.firstSelectedTile=void 0,t.secondSelectedTile=void 0,t.swappedTiles=[],t.triggeredSpecialTiles=[],t.isGamePaused=!1,t.isGameOver=!1,t.movesRemaining=g.Moves,t.hintActive=!1,t.isOnMilestoneAchievement=!1,t}n(t,e);var l=t.prototype;return l.__preload=function(){var e,t;if(this.assignManagers(),!this.boardManager)throw new Error("BoardManager is required");if(!this.matchManager)throw new Error("MatchManager is required");if(!this.animationManager)throw new Error("AnimationManager is required");if(!this.inputManager)throw new Error("InputManager is required");if(!this.specialTileManager)throw new Error("SpecialTileManager is required");if(!this.particleEffectManager)throw new Error("ParticleEffectManager is required");if(!this.pausePopup)throw new Error("PausePopup is required");this.milestoneAchievementUI=null==(e=this.milestoneUINode)?void 0:e.getComponent(k),this.progressUI=null==(t=this.progressUINode)?void 0:t.getComponent(C)},l.start=function(){this.setupProgressManager(),this.createBoard(),this.setupPauseButton()},l.update=function(e){this.checkIdleTime(e)},l.assignManagers=function(){var e;this.boardManager=this.node.getComponent(m),this.matchManager=this.node.getComponent(b),this.animationManager=this.node.getComponent(M),this.inputManager=this.node.getComponent(T),this.specialTileManager=this.node.getComponent(x),this.particleEffectManager=this.node.getComponent(y),this.pausePopup=null==(e=this.pausePopupUI)?void 0:e.getComponent(G)},l.setupProgressManager=function(){w.getInstance().onMilestoneCompleted(this.handleMilestoneCompleted.bind(this))},l.setupPauseButton=function(){this.pausePopup&&(this.setupPausePopupCallbacks(),this.setupPauseButtonEvents())},l.setupPausePopupCallbacks=function(){var e=this;this.pausePopup.setCallbacks((function(){var t;e.setGameInteractionEnabled(!0),v.getInstance().setIsGamePaused(!1),e.checkMatches(),null==(t=e.pausePopup)||t.hide()}),(function(){return e.startNewGame()}))},l.setupPauseButtonEvents=function(){var e,t,n,i,a,r=this;null==(e=this.pauseButton)||e.node.on(h.EventType.TOUCH_END,(function(){var e;r.isOnMilestoneAchievement||(null==(e=r.pausePopup)||e.show(),r.setGameInteractionEnabled(!1),v.getInstance().setIsGamePaused(!0))})),null==(t=this.pauseButton)||t.node.on(h.EventType.TOUCH_START,(function(){r.animatePauseButtonPress()})),null==(n=this.pauseButton)||n.node.on(h.EventType.TOUCH_END,(function(){r.animatePauseButtonRelease()})),null==(i=this.pauseButton)||i.node.on(h.EventType.MOUSE_ENTER,(function(){r.animatePauseButtonHover()})),null==(a=this.pauseButton)||a.node.on(h.EventType.MOUSE_LEAVE,(function(){r.animatePauseButtonLeave()}))},l.animatePauseButtonPress=function(){var e;p(null==(e=this.pauseButton)?void 0:e.node).to(.1,{scale:new f(.9,.9,1)},{easing:"quadOut"}).start()},l.animatePauseButtonRelease=function(){var e;p(null==(e=this.pauseButton)?void 0:e.node).to(.1,{scale:new f(1,1,1)},{easing:"quadOut"}).start()},l.animatePauseButtonHover=function(){var e;p(null==(e=this.pauseButton)?void 0:e.node).to(.1,{scale:new f(1.1,1.1,1)},{easing:"quadOut"}).start()},l.animatePauseButtonLeave=function(){var e;p(null==(e=this.pauseButton)?void 0:e.node).to(.1,{scale:new f(1,1,1)},{easing:"quadOut"}).start()},l.handleMilestoneCompleted=function(){var e=r(o().mark((function e(){var t,n,i,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.canMove=!1,v.getInstance().setIsMouseDown(!1),t=w.getInstance().getMilestoneData(),this.confettiSystem.createCelebrationConfetti(),this.milestoneAchievementUI&&(this.isOnMilestoneAchievement=!0,this.milestoneAchievementUI.showMilestoneAchievement(t)),this.clearBoard(),this.boardManager.initializeBoard(),this.resetFrames(),n=this.boardManager.getTileGrid(),i=this.animationManager.animateMilestoneCelebration(n,this.celebrationNode,(function(){a.isOnMilestoneAchievement=!1})),e.next=12,Promise.all([i]);case 12:return this.setupTileCallbacks(),this.firstSelectedTile=void 0,this.secondSelectedTile=void 0,this.movesRemaining=g.Moves,this.updateMovesDisplay(this.movesRemaining),e.next=19,this.resetTile();case 19:return e.next=21,this.checkMatches();case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.clearBoard=function(){for(var e=this.boardManager.getTileGrid(),t=0;t<g.GridHeight;t++)for(var n=0;n<g.GridWidth;n++){var i=e[t][n];i&&i.node&&i.node.isValid&&i.node.destroy(),this.boardManager.setTileAt(n,t,void 0)}},l.createBoard=function(){var e=r(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),this.canMove=!1,t||this.boardManager.createFrames(),v.getInstance().setIsMouseDown(!0),this.boardManager.initializeBoard(),this.setupTileCallbacks(),this.firstSelectedTile=void 0,this.secondSelectedTile=void 0,e.next=10,this.checkMatches();case 10:this.updateMovesDisplay(this.movesRemaining);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.setupTileCallbacks=function(){for(var e=this.boardManager.getTileGrid(),t=0;t<g.GridHeight;t++)for(var n=0;n<g.GridWidth;n++){var i=e[t][n];i&&(i.addOnMouseDownCallback(this.tileDown.bind(this)),i.addOnMouseUpCallback(this.tileDown.bind(this)),i.addOnRainbowClickCallback(this.handleRainbowClick.bind(this)))}},l.checkIdleTime=function(e){this.playerIdleTimeForHint+=e,this.playerIdleTimeForMaxIdle+=e,this.playerIdleTimeForHint>=g.HintTime&&(this.playerIdleTimeForHint=0,this.showHint()),this.playerIdleTimeForMaxIdle>=g.MaxIdleTime&&(this.playerIdleTimeForMaxIdle=0,this.animationManager.animateIdleTiles(this.boardManager.getTileGrid()))},l.tileDown=function(e){if(!v.getInstance().getIsGamePaused()&&!this.isGameOver&&this.canMove&&!this.isOnMilestoneAchievement)if(this.playerIdleTimeForHint=0,this.playerIdleTimeForMaxIdle=0,this.firstSelectedTile&&this.firstSelectedTile!==e){this.secondSelectedTile=e;var t=this.boardManager.getTileCoords(),n=t.get(this.firstSelectedTile),i=t.get(this.secondSelectedTile),a=Math.abs(n.x-i.x),r=Math.abs(n.y-i.y);1===a&&0===r||0===a&&1===r?(this.canMove=!1,this.swapTiles()):(this.firstSelectedTile.changeState("idle"),this.firstSelectedTile=e,e.changeState("select"),this.secondSelectedTile=void 0)}else this.firstSelectedTile=e,e.changeState("select")},l.isInBounds=function(e){return e.x>=0&&e.x<g.GridWidth&&e.y>=0&&e.y<g.GridHeight},l.swapTiles=function(){if(!this.firstSelectedTile||!this.secondSelectedTile)return this.canMove=!0,void v.getInstance().setIsMouseDown(!1);var e=this.boardManager.getTileCoords(),t=this.boardManager.getTileGrid(),n=e.get(this.firstSelectedTile),i=e.get(this.secondSelectedTile);return n&&i?this.isInBounds(n)&&this.isInBounds(i)?void this.performTileSwap(t,e,n,i):(console.error("Selected tile coordinates are out of bounds"),this.tileUp(),this.canMove=!0,void v.getInstance().setIsMouseDown(!1)):(console.error("Selected tile coordinates not found - tiles may have been destroyed"),this.tileUp(),this.canMove=!0,void v.getInstance().setIsMouseDown(!1))},l.performTileSwap=function(e,t,n,i){var a=this;this.firstSelectedTile&&this.secondSelectedTile&&(this.swappedTiles=[this.firstSelectedTile,this.secondSelectedTile],e[n.y][n.x]=this.secondSelectedTile,e[i.y][i.x]=this.firstSelectedTile,t.set(this.secondSelectedTile,{x:n.x,y:n.y}),t.set(this.firstSelectedTile,{x:i.x,y:i.y}),this.animationManager.animateSwap(this.firstSelectedTile,this.secondSelectedTile,(function(){return a.checkMatches(!0)})),this.firstSelectedTile=e[n.y][n.x],this.secondSelectedTile=e[i.y][i.x],this.firstSelectedTile&&this.secondSelectedTile&&(t.set(this.firstSelectedTile,{x:n.x,y:n.y}),t.set(this.secondSelectedTile,{x:i.x,y:i.y})))},l.checkMatches=function(){var e=r(o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=!1),!v.getInstance().getIsGamePaused()){e.next=3;break}return e.abrupt("return");case 3:if(n=this.boardManager.getTileGrid(),i=this.matchManager.findMatches(n),t&&this.swappedTiles.some((function(e){return e.isRainbowTile()}))&&i.push(this.swappedTiles),!(i.length>0)){e.next=15;break}return t&&this.processMove(),e.next=10,this.removeTileGroup(i);case 10:return e.next=12,this.resetTile();case 12:this.tileUp(),e.next=22;break;case 15:return e.next=17,this.checkMilestoneCompleted();case 17:if(!e.sent){e.next=20;break}return e.abrupt("return");case 20:t?this.swapTiles():(this.canMove=!0,v.getInstance().setIsMouseDown(!1),this.resetFrames(),this.checkGameOverConditions()),this.tileUp();case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.checkMilestoneCompleted=function(){var e=r(o().mark((function e(){var t,n,i,a,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.getInstance().processPendingScores()){e.next=3;break}return e.abrupt("return",!1);case 3:for(t=this.boardManager.getTileGrid(),n=!1,i=0;i<g.GridHeight&&!n;i++)for(a=0;a<g.GridWidth&&!n;a++)(r=t[i][a])&&r.node&&r.node.isValid&&(n=!0);if(!n){e.next=11;break}return e.next=9,this.handleMilestoneCompleted();case 9:e.next=14;break;case 11:console.warn("No valid tiles found for milestone animation, creating new board directly"),this.clearBoard(),this.createBoard();case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.resetFrames=function(){for(var e=this.boardManager.getTileGrid(),t=this.boardManager.getFrameGrid(),n=0;n<g.GridHeight;n++)for(var i=0;i<g.GridWidth;i++)e[n][i]&&t[n][i]&&e[n][i].setFrame(t[n][i])},l.resetTileFromExistingTile=function(e,t,n,i,a){for(var r=g.GridHeight-1;r>=0;r--)void 0!==e[r][a]&&n.push({tile:e[r][a],currentY:r});for(var s=0;s<g.GridHeight;s++)this.boardManager.setTileAt(a,s,void 0);for(var o=0;o<n.length;o++){var l=n[o],u=g.GridHeight-1-o;this.boardManager.setTileAt(a,u,l.tile),l.tile.setFrame(t[u][a]),l.currentY!==u&&i.push({tile:l.tile,fromY:l.currentY,toY:u,x:a,isNewTile:!1})}},l.resetTileFromVirtualTile=function(e,t,n,i,a){var r=g.GridHeight-n.length;if(r>0)for(var s=this.boardManager.getVirtualTilesForColumn(a,r),o=0;o<s.length;o++){var l=g.GridHeight-n.length-1-o,u=s[o];this.boardManager.setTileAt(a,l,u),u.addOnMouseDownCallback(this.tileDown.bind(this)),u.addOnMouseUpCallback(this.tileDown.bind(this)),u.addOnRainbowClickCallback(this.handleRainbowClick.bind(this)),u.setFrame(t[l][a]);var c=-(o+1);i.push({tile:u,fromY:c,toY:l,x:a,isNewTile:!1})}},l.resetTile=function(){var e=r(o().mark((function e(){var t,n,i,a,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=this.boardManager.getTileGrid(),i=this.boardManager.getFrameGrid(),this.boardManager.getTileCoords(),a=0;a<g.GridWidth;a++)r=[],this.resetTileFromExistingTile(n,i,r,t,a),this.resetTileFromVirtualTile(n,i,r,t,a);if(this.boardManager.refillVirtualGrid(),0!==t.length){e.next=10;break}return e.next=9,this.checkMatches();case 9:return e.abrupt("return");case 10:return e.next=12,this.animationManager.animateFall(t);case 12:if(this.hasSwappablePair()){e.next=15;break}return e.next=15,this.shuffleBoard();case 15:return e.next=17,this.checkMatches();case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.tileUp=function(){var e,t;null==(e=this.firstSelectedTile)||e.changeState("idle"),null==(t=this.secondSelectedTile)||t.changeState("idle"),this.firstSelectedTile=void 0,this.secondSelectedTile=void 0},l.handleCombineTile=function(e,t,n,i){var a=this;n.push(r(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.filter((function(e){return e!==i})),t.next=3,a.specialTileManager.createSpecialTile(i,4===e.length?I.BOMB:I.RAINBOW,n,(function(){for(var e,t=s(n);!(e=t()).done;){var i=e.value;i.node&&i.node.isValid&&i.node.destroy()}}));case 3:case"end":return t.stop()}}),t)}))));for(var l,u=s(e);!(l=u()).done;){var c=l.value;c!==i&&(t.has(c)&&this.boardManager.clearTileAt(t.get(c).x,t.get(c).y))}},l.handleSpecialTileDestroy=function(){var e=r(o().mark((function e(t,n,i,a){var r,l,u,c,h,d,p,f,g;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=t===this.firstSelectedTile?null!=(r=this.secondSelectedTile)?r:t:null!=(l=this.firstSelectedTile)?l:t,!t.isSpecial()){e.next=13;break}if(c=this.swappedTiles&&-1!==this.swappedTiles.indexOf(t),(h=this.specialTileManager.activateSpecialTile(t,u,i,c)).length>0)for(d=s(h);!(p=d()).done;)f=p.value,a.add(f);if(g=this.swappedTiles.filter((function(e){return e.isRainbowTile()})).length,!c||2!=g){e.next=12;break}return e.next=9,this.animationManager.animateDoubleRainbow(this.swappedTiles[0],this.swappedTiles[1],this.swappedTiles);case 9:return e.next=11,this.resolveDestroyAllForRainbow(this.swappedTiles);case 11:return e.abrupt("return",!0);case 12:!c&&t.isRainbowTile()&&n();case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),l.handleDestroyMatchTiles=function(){var e=r(o().mark((function e(t,n,i,a){var l,u,c,h,d=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=o().mark((function e(){var s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=h.value,i.has(s)&&i.get(s)){e.next=4;break}return n(),e.abrupt("return",0);case 4:return l=i.get(s),e.next=7,d.handleSpecialTileDestroy(s,n,l,t);case 7:if(!e.sent){e.next=10;break}return e.abrupt("return",{v:!0});case 10:a.push(r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&s.node&&s.node.isValid){e.next=3;break}return n(),e.abrupt("return");case 3:return s.isSpecial()&&d.particleEffectManager.playSpecialTileDestroyEffect(s.node.getWorldPosition(),s.node.parent,s.getSpecialType()),e.next=6,s.playDestroyAnimation();case 6:if(s.isSpecial()){e.next=9;break}return e.next=9,s.playParticleEffect();case 9:s.node.destroy(),n();case 11:case"end":return e.stop()}}),e)})))),d.boardManager.clearTileAt(l.x,l.y);case 12:case"end":return e.stop()}}),e)})),c=s(t);case 2:if((h=c()).done){e.next=11;break}return e.delegateYield(l(),"t0",4);case 4:if(0!==(u=e.t0)){e.next=7;break}return e.abrupt("continue",9);case 7:if(!u){e.next=9;break}return e.abrupt("return",u.v);case 9:e.next=2;break;case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),l.removeTileGroup=function(e){var t=this;return new Promise(r(o().mark((function n(i){var a,r,l,u,c,h,d,p,f,g,v,m,b,M,T;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(a=t.boardManager.getTileCoords(),r=new Set,l=0,u=[],c=s(e);!(h=c()).done;){if(p=h.value,f=p.length>=4&&p.every((function(e){return!e.isRainbowTile()})),g=null!=(d=p.find((function(e){return-1!==t.swappedTiles.indexOf(e)})))?d:p[0],f)t.handleCombineTile(p,a,u,g);else for(v=s(p);!(m=v()).done;)b=m.value,r.add(b);w.getInstance().addPendingScore(p.length,p.length)}if(0===u.length){n.next=10;break}return n.next=8,Promise.all(u.map((function(e){return e()})));case 8:return i(),n.abrupt("return");case 10:return M=[],T=function(){++l>=r.size&&i()},n.next=14,t.handleDestroyMatchTiles(r,T,a,M);case 14:if(!n.sent){n.next=18;break}return i(),n.abrupt("return");case 18:return n.next=20,Promise.all(M.map((function(e){return e()})));case 20:t.swappedTiles=[];case 21:case"end":return n.stop()}}),n)}))))},l.resolveDestroyAllForRainbow=function(){var e=r(o().mark((function e(t){var n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(r(o().mark((function e(i){var a,l,u,c,h,d,p,f,v,m,b,M,T,w;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new Map,l=n.boardManager.getTileCoords(),u=n.boardManager.getTileGrid(),c=t.map((function(e){return l.get(e)})),h=s(u);case 5:if((d=h()).done){e.next=17;break}p=d.value,f=o().mark((function e(){var t,i,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=m.value){e.next=3;break}return e.abrupt("return",1);case 3:s=l.get(i),u=Math.max(Math.min(Math.abs(s.x-c[0].x),Math.abs(s.x-c[1].x)),Math.min(Math.abs(s.y-c[0].y),Math.abs(s.y-c[1].y))),a.set(u,[].concat(null!=(t=a.get(u))?t:[],[r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.playDestroyAnimation();case 2:return e.next=4,i.playParticleEffect();case 4:i.node&&i.node.isValid&&i.node.destroy(),M();case 6:case"end":return e.stop()}}),e)})))])),n.boardManager.clearTileAt(s.x,s.y);case 7:case"end":return e.stop()}}),e)})),v=s(p);case 9:if((m=v()).done){e.next=15;break}return e.delegateYield(f(),"t0",11);case 11:if(!e.t0){e.next=13;break}return e.abrupt("continue",13);case 13:e.next=9;break;case 15:e.next=5;break;case 17:b=0,M=function(){++b>=g.GridWidth*g.GridHeight&&i()},T=0;case 20:if(!(T<=Math.max(g.GridWidth,g.GridHeight))){e.next=28;break}if(!(w=a.get(T))){e.next=25;break}return e.next=25,Promise.all(w.map((function(e){return e()})));case 25:T++,e.next=20;break;case 28:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.setGameInteractionEnabled=function(e){if(this.boardManager)for(var t=this.boardManager.getTileGrid(),n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++){var a=t[n][i];if(a){var r=a.getComponent(d);r&&(r.interactable=e)}}},l.startNewGame=function(){v.getInstance().setIsGamePaused(!1),this.isGameOver=!1,this.canMove=!1,this.movesRemaining=g.Moves,this.gameOverPopup&&this.gameOverPopup.hide(!1);var e=w.getInstance();e&&e.resetProgress(),this.clearBoard(),this.createBoard(!0),this.setGameInteractionEnabled(!0),this.updateMovesDisplay(this.movesRemaining)},l.checkGameOverConditions=function(){this.isGameOver||v.getInstance().getIsGamePaused()||this.movesRemaining<=0&&this.triggerGameOver()},l.triggerGameOver=function(){var e=this;this.isGameOver=!0,this.canMove=!1,this.setGameInteractionEnabled(!1),v.getInstance().setIsGameOver(!0);var t=w.getInstance(),n=t?t.getCurrentScore():0;this.gameOverPopup&&(this.gameOverPopup.show(n),this.gameOverPopup.setCallback((function(){e.startNewGame()})))},l.processMove=function(){this.isGameOver||(this.movesRemaining--,this.movesRemaining<0&&(this.movesRemaining=0),this.updateMovesDisplay(this.movesRemaining))},l.updateMovesDisplay=function(e){this.progressUI&&this.progressUI.updateMovesDisplay(e)},l.handleRainbowClick=function(){var e=r(o().mark((function e(t){var n,i,a,r,l,u,c,h=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.getInstance().getIsGamePaused()&&!this.isGameOver&&this.canMove){e.next=2;break}return e.abrupt("return");case 2:return this.canMove=!1,this.playerIdleTimeForHint=0,this.playerIdleTimeForMaxIdle=0,n=this.specialTileManager.activateSpecialTile(t,t,{x:0,y:0},!1,!0),e.next=8,this.animationManager.animateRainbowClickEffect(t);case 8:i=this.boardManager.getTileCoords(),(a=i.get(t))&&this.boardManager.clearTileAt(a.x,a.y),r=s(n);case 12:if((l=r()).done){e.next=26;break}if((u=l.value)&&u.node&&u.node.isValid){e.next=16;break}return e.abrupt("continue",24);case 16:return u.playDestroyAnimation(),e.next=19,u.playParticleEffect();case 19:return u.node&&u.node.isValid&&u.node.destroy(),e.next=22,new Promise((function(e){return h.scheduleOnce(e,.02)}));case 22:(c=i.get(u))&&this.boardManager.clearTileAt(c.x,c.y);case 24:e.next=12;break;case 26:return w.getInstance().addPendingScore(n.length,n.length),this.processMove(),e.next=30,this.resetTile();case 30:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.findSwappablePair=function(){for(var e=this.boardManager.getTileGrid(),t=0;t<g.GridHeight;t++)for(var n=0;n<g.GridWidth;n++){var i=e[t][n];if(i){if(n<g.GridWidth-1){var a=e[t][n+1];if(a&&this.wouldSwapResultInMatch(i,a,e))return[i,a]}if(t<g.GridHeight-1){var r=e[t+1][n];if(r&&this.wouldSwapResultInMatch(i,r,e))return[i,r]}}}return null},l.wouldSwapResultInMatch=function(e,t,n){for(var i=-1,a=-1,r=-1,s=-1,o=0;o<g.GridHeight;o++)for(var l=0;l<g.GridWidth;l++)n[o][l]===e&&(a=o,i=l),n[o][l]===t&&(s=o,r=l);if(-1===i||-1===a||-1===r||-1===s)return!1;n[a][i]=t,n[s][r]=e;var u=this.matchManager.findMatches(n);return n[a][i]=e,n[s][r]=t,u.length>0},l.showHint=function(){var e=r(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hintActive){e.next=2;break}return e.abrupt("return");case 2:if(i=this.findSwappablePair()){e.next=5;break}return e.abrupt("return");case 5:return this.hintActive=!0,e.next=8,Promise.all([null==(t=i[0].getComponent(M))?void 0:t.animatePulse(10),null==(n=i[1].getComponent(M))?void 0:n.animatePulse(10)]);case 8:this.hintActive=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.hasSwappablePair=function(){return null!==this.findSwappablePair()},l.shuffleBoard=function(){var e=r(o().mark((function e(){var t,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.boardManager.getTileGrid(),n=this.collectAllTiles(t),i=0;case 3:if(this.shuffleArray(n),this.repositionTiles(n,t),this.updateTileCoordinates(t),!(++i>20)){e.next=9;break}return e.abrupt("break",10);case 9:if(!this.hasSwappablePair()){e.next=3;break}case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.collectAllTiles=function(e){for(var t=[],n=0;n<g.GridHeight;n++)for(var i=0;i<g.GridWidth;i++){var a=e[n][i];a&&t.push(a)}return t},l.shuffleArray=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e[n],e[t]];e[t]=i[0],e[n]=i[1]}},l.repositionTiles=function(e,t){for(var n=0,i=0;i<g.GridHeight;i++)for(var a=0;a<g.GridWidth;a++)if(t[i][a]){t[i][a]=e[n++];var r=this.boardManager.getWorldPosition({x:a,y:i});t[i][a].node.setPosition(r.x,r.y,0)}},l.updateTileCoordinates=function(e){var t=this.boardManager.getTileCoords();t.clear();for(var n=0;n<g.GridHeight;n++)for(var i=0;i<g.GridWidth;i++){var a=e[n][i];a&&t.set(a,{x:i,y:n})}},l.onDestroy=function(){var e,t;null!=(e=this.pauseButton)&&e.node&&(this.pauseButton.node.off(h.EventType.TOUCH_END),this.pauseButton.node.off(h.EventType.TOUCH_START),this.pauseButton.node.off(h.EventType.MOUSE_ENTER),this.pauseButton.node.off(h.EventType.MOUSE_LEAVE));var n=w.getInstance();n&&n.offMilestoneCompleted(this.handleMilestoneCompleted.bind(this)),this.pausePopup&&this.pausePopup.destroy(),null!=(t=this.pauseButton)&&t.node&&p(this.pauseButton.node).stop(),this.firstSelectedTile=void 0,this.secondSelectedTile=void 0,this.swappedTiles=[],this.triggeredSpecialTiles=[]},t}(S)).prototype,"camera",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(_.prototype,"celebrationNode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(_.prototype,"milestoneUINode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(_.prototype,"progressUINode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(_.prototype,"pausePopupUI",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(_.prototype,"gameOverPopup",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(_.prototype,"pauseButton",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(_.prototype,"confettiSystem",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=_))||W));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameOverPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,n,i,a,r,s,l,c,h,u,p,d,g,b,f,w,v,m,S;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,s=e._decorator,l=e.Node,c=e.Label,h=e.Button,u=e.sys,p=e.Sprite,d=e.Color,g=e.Vec2,b=e.UITransform,f=e.tween,w=e.Vec3,v=e.EventHandler,m=e.UIOpacity,S=e.Component}],execute:function(){var L,C,y,O,P,E,B,G,k,T,H,N,U,z,q;r._RF.push({},"b2c3dTl9qeJAbzeI0VniQEj","GameOverPopup",void 0);var I=s.ccclass,M=s.property;e("GameOverPopup",(L=I("GameOverPopup"),C=M(l),y=M(l),O=M(c),P=M(c),E=M(c),B=M(h),L((T=t((k=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,n(t,"popupPanel",T,i(t)),n(t,"backgroundOverlay",H,i(t)),n(t,"titleLabel",N,i(t)),n(t,"scoreLabel",U,i(t)),n(t,"highScoreLabel",z,i(t)),n(t,"newGameButton",q,i(t)),t.isVisible=!1,t.onNewGameCallback=null,t.currentScore=0,t.highScore=0,t}o(t,e);var r=t.prototype;return r.start=function(){this.loadHighScore(),this.enhanceExistingUI(),this.setupButtons(),this.hide(!1)},r.loadHighScore=function(){var e=u.localStorage.getItem("candyCrushHighScore");this.highScore=e?parseInt(e):0},r.saveHighScore=function(){u.localStorage.setItem("candyCrushHighScore",this.highScore.toString())},r.enhanceExistingUI=function(){this.enhancePopupPanel(),this.enhanceBackgroundOverlay(),this.enhanceTitleLabel(),this.enhanceScoreLabel(),this.enhanceNewGameButton(),this.addVisualEffects()},r.enhancePopupPanel=function(){if(this.popupPanel){var e=this.popupPanel.getComponent(p);e&&(e.color=new d(40,15,25,245))}},r.enhanceBackgroundOverlay=function(){if(this.backgroundOverlay){var e=this.backgroundOverlay.getComponent(p);e&&(e.color=new d(0,0,0,180))}},r.enhanceTitleLabel=function(){this.titleLabel&&(this.titleLabel.string="GAME OVER",this.titleLabel.fontSize=30,this.titleLabel.isBold=!0,this.titleLabel.color=new d(220,20,60,255),this.titleLabel.enableOutline=!0,this.titleLabel.outlineColor=new d(139,0,0,255),this.titleLabel.outlineWidth=4,this.titleLabel.enableShadow=!0,this.titleLabel.shadowColor=new d(0,0,0,200),this.titleLabel.shadowOffset=new g(4,-4),this.titleLabel.shadowBlur=6)},r.enhanceScoreLabel=function(){this.scoreLabel&&(this.scoreLabel.fontSize=52,this.scoreLabel.isBold=!0,this.scoreLabel.color=new d(255,215,0,255),this.scoreLabel.enableOutline=!0,this.scoreLabel.outlineColor=new d(139,69,19,255),this.scoreLabel.outlineWidth=3,this.scoreLabel.enableShadow=!0,this.scoreLabel.shadowColor=new d(255,165,0,150),this.scoreLabel.shadowOffset=new g(2,-2),this.scoreLabel.shadowBlur=8)},r.enhanceNewGameButton=function(){if(this.newGameButton){var e=this.newGameButton.getComponent(p);e&&(e.color=new d(255,140,0,255));var t=this.newGameButton.node.getChildByName("Label");if(t){var o=t.getComponent(c);o&&(o.string="NEW GAME",o.fontSize=14,o.isBold=!0,o.color=new d(255,255,255,255),o.enableOutline=!0,o.outlineColor=new d(0,0,0,200),o.outlineWidth=2,o.enableShadow=!0,o.shadowColor=new d(0,0,0,150),o.shadowOffset=new g(1,-1),o.shadowBlur=3)}}},r.addVisualEffects=function(){this.createFloatingParticles(),this.addBorderGlow()},r.createFloatingParticles=function(){if(this.popupPanel)for(var e=0;e<8;e++){var t=new l("Particle"+e);this.popupPanel.addChild(t),t.addComponent(b).setContentSize(6,6);var o=t.addComponent(p);o.color=new d(255,215,0,150);var n=e/8*Math.PI*2,i=180+40*Math.random(),a=Math.cos(n)*i,r=Math.sin(n)*i;t.setPosition(a,r,0),f(t).to(3+2*Math.random(),{position:new w(a+60*(Math.random()-.5),r+20,0)}).to(3+2*Math.random(),{position:new w(a,r,0)}).union().repeatForever().start(),f(o).to(1.5,{color:new d(255,215,0,50)}).to(1.5,{color:new d(255,215,0,150)}).union().repeatForever().start()}},r.addBorderGlow=function(){if(this.popupPanel){var e=new l("GlowBorder");this.popupPanel.addChild(e),e.setSiblingIndex(0);var t=e.addComponent(b),o=this.popupPanel.getComponent(b);o&&t.setContentSize(o.contentSize.width+20,o.contentSize.height+20);var n=e.addComponent(p);n.color=new d(255,215,0,30),f(n).to(2,{color:new d(255,215,0,60)}).to(2,{color:new d(255,215,0,30)}).union().repeatForever().start()}},r.setupButtons=function(){if(this.newGameButton){this.setupButtonAnimations(this.newGameButton);var e=new v;e.target=this.node,e.component="GameOverPopup",e.handler="onNewGameClicked",this.newGameButton.clickEvents.push(e)}},r.setupButtonAnimations=function(e){var t=e.node,o=t.scale.clone(),n=e.node.getComponent(p),i=n.color.clone();t.on(l.EventType.MOUSE_ENTER,(function(){f(t).to(.1,{scale:new w(1.1,1.1,1)},{easing:"quadOut"}).start(),f(n).to(.1,{color:new d(i.r+40,i.g+40,i.b+40,i.a)}).start()})),t.on(l.EventType.MOUSE_LEAVE,(function(){f(t).to(.1,{scale:o},{easing:"quadOut"}).start(),f(n).to(.1,{color:i}).start()})),t.on(l.EventType.TOUCH_START,(function(){f(t).to(.05,{scale:new w(.95,.95,1)},{easing:"quadOut"}).start()})),t.on(l.EventType.TOUCH_END,(function(){f(t).to(.15,{scale:new w(1.15,1.15,1)},{easing:"backOut"}).to(.1,{scale:o},{easing:"quadOut"}).start()})),t.on(l.EventType.TOUCH_CANCEL,(function(){f(t).to(.1,{scale:o},{easing:"quadOut"}).start()}))},r.show=function(e){var t=this;if(!this.isVisible){if(this.currentScore=e,this.checkAndUpdateHighScore(),this.updateScoreDisplays(),this.isVisible=!0,this.node.active=!0,this.popupPanel){this.popupPanel.setScale(0,0,1);var o=this.popupPanel.getComponent(m);o||(o=this.popupPanel.addComponent(m)),o.opacity=0}if(this.backgroundOverlay){var n=this.backgroundOverlay.getComponent(m);n||(n=this.backgroundOverlay.addComponent(m)),n.opacity=0}if(this.backgroundOverlay){var i=this.backgroundOverlay.getComponent(m);f(i).to(.4,{opacity:255},{easing:"quadOut"}).start()}if(this.popupPanel){var a=this.popupPanel.getComponent(m);f(a).to(.5,{opacity:255},{easing:"quadOut"}).start(),f(this.popupPanel).to(.2,{scale:new w(.3,.3,1)},{easing:"quadOut"}).to(.4,{scale:new w(1.3,1.3,1)},{easing:"backOut"}).to(.2,{scale:new w(1,1,1)},{easing:"quadOut"}).start()}if(this.scoreLabel){var r=0;f(this.scoreLabel).to(1.5,{},{easing:"quadOut",onUpdate:function(e,o){r=Number(t.currentScore)*(null!=o?o:0),e.string=Math.floor(r).toLocaleString()}}).start()}this.animateScoreCounting()}},r.animateScoreCounting=function(){if(this.scoreLabel){this.currentScore;f(this.scoreLabel).to(1.5,{string:this.highScore.toLocaleString()},{easing:"quadOut"}).start()}},r.checkAndUpdateHighScore=function(){this.currentScore>this.highScore&&(this.highScore=this.currentScore,this.saveHighScore(),this.celebrateNewHighScore())},r.celebrateNewHighScore=function(){if(this.highScoreLabel){var e=this.highScoreLabel.color.clone();f(this.highScoreLabel).to(.2,{color:new d(255,215,0,255)}).to(.2,{color:new d(255,255,255,255)}).to(.2,{color:new d(255,215,0,255)}).to(.2,{color:e}).start(),f(this.highScoreLabel.node).to(.3,{scale:new w(1.3,1.3,1)},{easing:"backOut"}).to(.2,{scale:new w(1,1,1)},{easing:"quadOut"}).start()}},r.updateScoreDisplays=function(){this.scoreLabel&&(this.scoreLabel.string="0"),this.highScoreLabel&&(this.highScoreLabel.string=this.highScore.toLocaleString())},r.hide=function(e){var t=this;if(void 0===e&&(e=!0),this.isVisible||!e)if(this.isVisible=!1,e){if(this.popupPanel){var o=this.popupPanel.getComponent(m);o||(o=this.popupPanel.addComponent(m)),f(this.popupPanel).to(.3,{scale:new w(.6,.6,1)},{easing:"backIn"}).start(),f(o).to(.3,{opacity:0},{easing:"quadIn"}).start()}if(this.backgroundOverlay){var n=this.backgroundOverlay.getComponent(m);n||(n=this.backgroundOverlay.addComponent(m)),f(n).to(.25,{opacity:0},{easing:"quadIn"}).call((function(){t.node.active=!1})).start()}else setTimeout((function(){t.node.active=!1}),300)}else this.node.active=!1},r.setCallback=function(e){this.onNewGameCallback=e},r.onNewGameClicked=function(){var e=this;this.hide(),this.onNewGameCallback&&setTimeout((function(){return e.onNewGameCallback()}),300)},r.getHighScore=function(){return this.highScore},r.resetHighScore=function(){this.highScore=0,this.saveHighScore(),this.highScoreLabel&&(this.highScoreLabel.string="0")},r.onDestroy=function(){var e,t,o;if(null!=(e=this.newGameButton)&&e.node&&(this.newGameButton.node.off(l.EventType.MOUSE_ENTER),this.newGameButton.node.off(l.EventType.MOUSE_LEAVE),this.newGameButton.node.off(l.EventType.TOUCH_START),this.newGameButton.node.off(l.EventType.TOUCH_END),this.newGameButton.node.off(l.EventType.TOUCH_CANCEL)),this.popupPanel){f(this.popupPanel).stop();for(var n,i=this.popupPanel.children.filter((function(e){return e.name.startsWith("Particle")})),r=a(i);!(n=r()).done;){var s=n.value;f(s).stop();var c=s.getComponent(p);c&&f(c).stop()}var h=this.popupPanel.getChildByName("GlowBorder");if(h){var u=h.getComponent(p);u&&f(u).stop()}}if(this.backgroundOverlay){var d=this.backgroundOverlay.getComponent(m);d&&f(d).stop()}null!=(t=this.titleLabel)&&t.node&&f(this.titleLabel.node).stop(),this.scoreLabel&&f(this.scoreLabel).stop(),null!=(o=this.highScoreLabel)&&o.node&&(f(this.highScoreLabel.node).stop(),f(this.highScoreLabel).stop()),this.onNewGameCallback=null},t}(S)).prototype,"popupPanel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(k.prototype,"backgroundOverlay",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(k.prototype,"titleLabel",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(k.prototype,"scoreLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(k.prototype,"highScoreLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(k.prototype,"newGameButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=k))||G));r._RF.pop()}}}));

System.register("chunks:///_virtual/IdleState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TileState.ts","./AnimationManager.ts"],(function(n){var t,e,i,a;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy},function(n){i=n.TileState},function(n){a=n.AnimationManager}],execute:function(){e._RF.push({},"22289Nm7F9CA4w+U3Kkqxb/","IdleState",void 0);n("IdleState",function(n){function e(t){var e;return(e=n.call(this,t)||this).animationHandler=null,e.animationHandler=t.getComponent(a),e}t(e,n);var i=e.prototype;return i.onEnter=function(){var n,t;null==(n=this.animationHandler)||n.updateOriginalValues(),null==(t=this.animationHandler)||t.stopAllAnimations()},i.onExit=function(){},i.onUpdate=function(){},i.onPlayerIdle=function(){var n;null==(n=this.animationHandler)||n.animatePlayerIdle()},e}(i));e._RF.pop()}}}));

System.register("chunks:///_virtual/InputManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,s,n;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,s=e._decorator,n=e.Component}],execute:function(){var l;i._RF.push({},"27ed9f/giNFtYZoHrSdQky5","InputManager",void 0);var r=s.ccclass;e("InputManager",r("InputManager")(l=function(e){function i(){for(var t,i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).firstSelectedTile=void 0,t.secondSelectedTile=void 0,t.boardManager=null,t.canMove=!0,t}t(i,e);var s=i.prototype;return s.setBoardManager=function(e){this.boardManager=e},s.setCanMove=function(e){this.canMove=e},s.getCanMove=function(){return this.canMove},s.handleTileClick=function(e){if(!this.canMove||!this.boardManager)return{isValid:!1,shouldSwap:!1,firstTile:e};if(!this.firstSelectedTile||this.firstSelectedTile===e)return this.selectFirstTile(e),{isValid:!0,shouldSwap:!1,firstTile:e};if(this.secondSelectedTile=e,this.areAdjacent(this.firstSelectedTile,this.secondSelectedTile)){var t={isValid:!0,shouldSwap:!0,firstTile:this.firstSelectedTile,secondTile:this.secondSelectedTile};return this.canMove=!1,t}return this.deselectAll(),this.selectFirstTile(e),{isValid:!0,shouldSwap:!1,firstTile:e}},s.swapCompleted=function(){this.canMove=!0,this.deselectAll()},s.swapFailed=function(){this.canMove=!0},s.getSelectedTiles=function(){return{first:this.firstSelectedTile,second:this.secondSelectedTile}},s.deselectAll=function(){var e,t;null==(e=this.firstSelectedTile)||e.changeState("idle"),null==(t=this.secondSelectedTile)||t.changeState("idle"),this.firstSelectedTile=void 0,this.secondSelectedTile=void 0},s.selectFirstTile=function(e){this.deselectAll(),this.firstSelectedTile=e,e.changeState("select")},s.areAdjacent=function(e,t){if(!this.boardManager)return!1;var i=this.boardManager.getTileCoords().get(e),s=this.boardManager.getTileCoords().get(t);if(!i||!s)return!1;var n=Math.abs(i.x-s.x),l=Math.abs(i.y-s.y);return 1===n&&0===l||0===n&&1===l},s.reset=function(){this.deselectAll(),this.canMove=!0},i}(n))||l);i._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AssetLoader.ts","./ConfettiParticle.ts","./ConfettiSystem.ts","./Frame.ts","./GameGlobalData.ts","./GameManager.ts","./ProgressUI.ts","./Tile.ts","./AnimationManager.ts","./AudioManager.ts","./BoardManager.ts","./InputManager.ts","./MatchManager.ts","./ParticleEffectManager.ts","./ProgressManager.ts","./SpecialTileManager.ts","./Singleton.ts","./IdleState.ts","./SelectState.ts","./TileState.ts","./GameOverPopup.ts","./MilestoneAchievementUI.ts","./PausePopup.ts","./AnimationConfig.ts","./GameConfig.ts","./SpecialTileConfig.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MatchManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./SpecialTileConfig.ts"],(function(e){var t,n,a,r,i,o,c,h;return{setters:[function(e){t=e.inheritsLoose,n=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,r=e._decorator,i=e.Component},function(e){o=e.GameConfig,c=e.PatternShape},function(e){h=e.SpecialTileType}],execute:function(){var s;a._RF.push({},"32a97mjyCxIAaOfDGLjqzvl","MatchManager",void 0);var u=r.ccclass;e("MatchManager",u("MatchManager")(s=function(e){function a(){return e.apply(this,arguments)||this}t(a,e);var r=a.prototype;return r.findMatches=function(e){var t=[],n=new Set;return this.findShapeMatches(e,t,n),t},r.findShapeMatches=function(e,t,n){for(var a=this,r=function(r){var i=c.filter((function(e){return e.shape.length===r}));a.findShapeMatchesByPatterns(e,t,n,i)},i=5;i>=3;i--)r(i)},r.findShapeMatchesByPatterns=function(e,t,a,r){for(var i=0;i<e.length;i++)for(var o=0;o<e[i].length;o++){var c=e[i][o];if(c&&!a.has(c)&&c.getSpecialType()!==h.RAINBOW)for(var s,u=n(r);!(s=u()).done;){var f=s.value,l=this.findPatternMatch(e,o,i,f,a);if(l){t.push(l);for(var p,v=n(l);!(p=v()).done;){var d=p.value;a.add(d)}}}}},r.isInGrid=function(e,t){return e>=0&&e<o.GridWidth&&t>=0&&t<o.GridHeight},r.findPatternMatch=function(e,t,a,r,i){for(var o,c,h=[],s=r.shape,u=null==(o=e[a][t])?void 0:o.getTileType(),f=n(s);!(c=f()).done;){var l=c.value,p=t+l.x,v=a+l.y;if(!this.isInGrid(p,v))return null;var d=e[v][p];if(!d||i.has(d)||d.getTileType()!==u||d.isRainbowTile())return null;h.push(d)}return h.length>=r.shape.length?h:null},a}(i))||s);a._RF.pop()}}}));

System.register("chunks:///_virtual/MilestoneAchievementUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfettiSystem.ts"],(function(e){var t,n,r,i,a,l,o,c,s,u,p,f,h,b,m,v,g,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){o=e.cclegacy,c=e._decorator,s=e.Node,u=e.Label,p=e.Sprite,f=e.Prefab,h=e.Tween,b=e.Component,m=e.UIOpacity,v=e.tween,g=e.Vec3},function(e){y=e.ConfettiSystem}],execute:function(){var d,w,P,L,S,I,x,k,z,A,E,M,T,C,q,D,U;o._RF.push({},"583aatI2IlIeqzd1+f18JPf","MilestoneAchievementUI",void 0);var _=c.ccclass,B=c.property;e("MilestoneAchievementUI",(d=_("MilestoneAchievementUI"),w=B(s),P=B(u),L=B(u),S=B(u),I=B(p),x=B(f),k=B(y),d((E=t((A=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return t=e.call.apply(e,[this].concat(a))||this,r(t,"achievementPanel",E,i(t)),r(t,"titleLabel",M,i(t)),r(t,"levelLabel",T,i(t)),r(t,"messageLabel",C,i(t)),r(t,"backgroundSprite",q,i(t)),r(t,"confettiPrefab",D,i(t)),r(t,"confettiSystem",U,i(t)),t}n(t,e);var o=t.prototype;return o.showMilestoneAchievement=function(){var e=a(l().mark((function e(t,n){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updateLabels(t),this.node.active=!0,this.achievementPanel&&(this.achievementPanel.setScale(0,0,0),(r=this.achievementPanel.getComponent(m))&&(r.opacity=255)),e.next=5,this.animateEntrance();case 5:return e.next=7,new Promise((function(e){return setTimeout(e,3e3)}));case 7:return e.next=9,this.animateExit();case 9:this.node.active=!1;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),o.updateLabels=function(e){this.titleLabel&&(this.titleLabel.string="MILESTONE ACHIEVED!"),this.levelLabel&&(this.levelLabel.string="LEVEL "+e.currentMilestone),this.messageLabel&&(this.messageLabel.string="Congratulations!\nYou've reached level "+e.currentMilestone+"!\nTotal Score: "+e.currentScore)},o.animateEntrance=function(){var e=a(l().mark((function e(){var t=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.achievementPanel){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){v(t.achievementPanel).to(.5,{scale:new g(1.1,1.1,1.1)},{easing:"quadOut"}).to(.2,{scale:new g(1,1,1)},{easing:"quadIn"}).call((function(){e()})).start()})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.animateExit=function(){var e=a(l().mark((function e(t){var n=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.achievementPanel){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){var r=n.achievementPanel.getComponent(m);r&&v(r).to(.3,{opacity:0},{easing:"quadIn"}).start(),v(n.achievementPanel).to(.3,{scale:new g(.8,.8,.8)},{easing:"quadIn"}).call((function(){e(),null==t||t()})).start()})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.onDestroy=function(){this.achievementPanel&&h.stopAllByTarget(this.achievementPanel),this.backgroundSprite&&h.stopAllByTarget(this.backgroundSprite),this.confettiSystem&&this.confettiSystem.clearAllParticles()},t}(b)).prototype,"achievementPanel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(A.prototype,"titleLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(A.prototype,"levelLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(A.prototype,"messageLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(A.prototype,"backgroundSprite",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(A.prototype,"confettiPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(A.prototype,"confettiSystem",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=A))||z));o._RF.pop()}}}));

System.register("chunks:///_virtual/ParticleEffectManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SpecialTileConfig.ts"],(function(e){var t,n,r,i,o,a,c,f,u,s,l,p,h,b,d,w,E;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose,a=e.asyncToGenerator,c=e.regeneratorRuntime},function(e){f=e.cclegacy,u=e._decorator,s=e.Prefab,l=e.Vec3,p=e.UITransform,h=e.instantiate,b=e.ParticleSystem2D,d=e.Color,w=e.Component},function(e){E=e.SpecialTileType}],execute:function(){var y,v,g,m,C,k,x,P,B,T,A,O,S,z,M,V,I,R,N;f._RF.push({},"e3f4g5h6-i7j8-9012-3456-789012cdefgh","ParticleEffectManager",void 0);var W=u.ccclass,D=u.property;e("ParticleEffectManager",(y=W("ParticleEffectManager"),v=D(s),g=D(s),m=D(s),C=D(s),k=D(s),x=D(s),P=D(s),B=D(s),y((O=t((A=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,r(t,"bombCreationEffect",O,i(t)),r(t,"rainbowCreationEffect",S,i(t)),r(t,"bombActivationEffect",z,i(t)),r(t,"rainbowActivationEffect",M,i(t)),r(t,"explosionEffect",V,i(t)),r(t,"sparkleEffect",I,i(t)),r(t,"confettiEffect",R,i(t)),r(t,"shockwaveEffect",N,i(t)),t}n(t,e);var f=t.prototype;return f.playSpecialTileCreationEffect=function(){var e=a(c().mark((function e(t,n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.getCreationEffectPrefab(n))&&t.node&&t.node.isValid){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.playEffect(r,t.node.worldPosition,t.node.parent));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),f.playSpecialTileActivationEffect=function(e,t){var n=this.getActivationEffectPrefab(t);n&&e.node&&e.node.isValid&&this.playEffect(n,e.node.worldPosition,e.node.parent)},f.playExplosionEffect=function(){var e=a(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.explosionEffect){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this.playEffect(this.explosionEffect,t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),f.playSparkleEffect=function(){var e=a(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sparkleEffect){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this.playEffect(this.sparkleEffect,t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),f.playConfettiEffect=function(){var e=a(c().mark((function e(t,n,r){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.confettiEffect||this.sparkleEffect){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",this.playColoredEffect(i,t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),f.playMilestoneConfetti=function(){var e=a(c().mark((function e(t){var n,r,i,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[new d(255,215,0,255),new d(255,20,147,255),new d(0,191,255,255),new d(50,205,50,255),new d(255,165,0,255),new d(138,43,226,255)],r=this.generateConfettiPositions(t),i=r.map((function(e,r){return new Promise((function(i){setTimeout((function(){var a=n[r%n.length];o.playConfettiEffect(e,t,a).then(i)}),150*r)}))})),e.next=5,Promise.all(i);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),f.generateConfettiPositions=function(e){var t=[],n=this.getNodeBounds(e);return t.push(new l(n.left+100,n.top-100,0),new l(n.right-100,n.top-100,0),new l(n.center.x,n.top-50,0),new l(n.left+50,n.center.y+100,0),new l(n.right-50,n.center.y+100,0),new l(n.center.x-200,n.top-150,0),new l(n.center.x+200,n.top-150,0)),t},f.getNodeBounds=function(e){try{var t=e.getComponent(p);if(t&&t.contentSize){var n=t.contentSize;return{left:-n.width/2,right:n.width/2,top:n.height/2,bottom:-n.height/2,center:{x:0,y:0}}}}catch(e){console.warn("Could not get node bounds, using defaults:",e)}return{left:-400,right:400,top:300,bottom:-300,center:{x:0,y:0}}},f.getCreationEffectPrefab=function(e){switch(e){case E.BOMB:return this.bombCreationEffect;case E.RAINBOW:return this.rainbowCreationEffect;default:return null}},f.getActivationEffectPrefab=function(e){switch(e){case E.BOMB:return this.bombActivationEffect;case E.RAINBOW:return this.rainbowActivationEffect;default:return null}},f.playEffect=function(e,t,n){if(n){var r=h(e);n.addChild(r),r.setWorldPosition(t);var i=r.getComponent(b);i&&(i.playOnLoad=!0,setTimeout((function(){r&&r.isValid&&r.destroy()}),3e3))}},f.playColoredEffect=function(e,t,n,r){if(n){var i=h(e);n.addChild(i),i.setWorldPosition(t);var o=i.getComponent(b);o&&(o.playOnLoad=!0,r&&(o.startColor=r,o.endColor=r,o.startColorVar=new d(50,50,50,0),o.endColorVar=new d(50,50,50,0)),setTimeout((function(){i&&i.isValid&&i.destroy()}),3e3))}},f.playMultipleEffects=function(){var e=a(c().mark((function e(t,n,r){var i,o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.map((function(e,t){return new Promise((function(i){setTimeout((function(){"explosion"===n?o.playExplosionEffect(e,r).then(i):"sparkle"===n?o.playSparkleEffect(e,r).then(i):"confetti"===n?o.playConfettiEffect(e,r).then(i):"shockwave"===n?o.playShockwaveEffect(e,r).then(i):i()}),100*t)}))})),e.next=3,Promise.all(i);case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),f.playSpecialTileDestroyEffect=function(){var e=a(c().mark((function e(t,n,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shockwaveEffect){e.next=2;break}return e.abrupt("return");case 2:e.t0=r,e.next=e.t0===E.BOMB?5:e.t0===E.RAINBOW?6:7;break;case 5:return e.abrupt("return",this.playEffect(this.shockwaveEffect,t,n));case 6:case 7:return e.abrupt("break",8);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),f.getParticleEffectPrefab=function(e){switch(e){case E.BOMB:return this.bombCreationEffect;case E.RAINBOW:return this.rainbowCreationEffect;default:return null}},f.createTileParticleEffect=function(e,t){if(e.node&&e.node.isValid){var n=e.getTileType().color,r=this.getParticleEffectPrefab(t);if(r){var i=h(r);i.setParent(e.node),e.node.addChild(i),i.setPosition(0,0,0);var o=i.getComponent(b);o&&t!==E.RAINBOW&&(o.startColor=n,o.startColorVar=new d(0,0,0,255),o.endColor=n,o.endColorVar=new d(0,0,0,255),o.playOnLoad=!0)}}},f.playShockwaveEffect=function(){var e=a(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shockwaveEffect){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",this.playEffect(this.shockwaveEffect,t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),f.onDestroy=function(){for(var e,t=o(this.node.children);!(e=t()).done;){var n=e.value;n.isValid&&n.destroy()}},t}(w)).prototype,"bombCreationEffect",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(A.prototype,"rainbowCreationEffect",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(A.prototype,"bombActivationEffect",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(A.prototype,"rainbowActivationEffect",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(A.prototype,"explosionEffect",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(A.prototype,"sparkleEffect",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(A.prototype,"confettiEffect",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(A.prototype,"shockwaveEffect",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=A))||T));f._RF.pop()}}}));

System.register("chunks:///_virtual/PausePopup.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,o,i,a,u,s,l,r,p,c,h,d,g,f,b,C,v,m,y;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,o=n.initializerDefineProperty,i=n.assertThisInitialized,a=n.createForOfIteratorHelperLoose},function(n){u=n.cclegacy,s=n._decorator,l=n.Node,r=n.Button,p=n.Toggle,c=n.Label,h=n.EventHandler,d=n.Sprite,g=n.tween,f=n.Vec3,b=n.Color,C=n.UIOpacity,v=n.Tween,m=n.AudioSource,y=n.Component}],execute:function(){var T,k,P,w,O,E,B,N,G,S,_,U,A,H,V;u._RF.push({},"a1b2cPU5fZ4kKvNEjRWeJAS","PausePopup",void 0);var D=s.ccclass,q=s.property;n("PausePopup",(T=D("PausePopup"),k=q(l),P=q(l),w=q(r),O=q(r),E=q(p),B=q(c),T((S=e((G=function(n){function e(){for(var e,t=arguments.length,a=new Array(t),u=0;u<t;u++)a[u]=arguments[u];return e=n.call.apply(n,[this].concat(a))||this,o(e,"popupPanel",S,i(e)),o(e,"backgroundOverlay",_,i(e)),o(e,"continueButton",U,i(e)),o(e,"newGameButton",A,i(e)),o(e,"soundToggle",H,i(e)),o(e,"titleLabel",V,i(e)),e.isVisible=!1,e.onContinueCallback=null,e.onNewGameCallback=null,e}t(e,n);var u=e.prototype;return u.start=function(){this.isVisible=!1,this.setupButtons(),this.hide(!1),this.enhanceVisualStyling()},u.setupButtons=function(){var n=this;if(this.continueButton){this.setupButtonAnimations(this.continueButton);var e=new h;e.target=this.node,e.component="PausePopup",e.handler="onContinueClicked",this.continueButton.node.on(l.EventType.TOUCH_END,(function(){n.onContinueClicked()}))}if(this.newGameButton){this.setupButtonAnimations(this.newGameButton);var t=new h;t.target=this.node,t.component="PausePopup",t.handler="onNewGameClicked",this.newGameButton.node.on(l.EventType.TOUCH_END,(function(){n.onNewGameClicked()}))}if(this.soundToggle){var o=new h;o.target=this.node,o.component="PausePopup",o.handler="onSoundToggled",this.soundToggle.checkEvents.push(o),this.soundToggle.isChecked=!0}},u.setupButtonAnimations=function(n){var e=n.node,t=e.scale.clone(),o=e.getComponent(d),i=o.color.clone();e.on(l.EventType.MOUSE_ENTER,(function(){g(e).to(.1,{scale:new f(1.1,1.1,1)},{easing:"quadOut"}).start(),g(o).to(.1,{color:new b(i.r+30,i.g+30,i.b+30,i.a)}).start()})),e.on(l.EventType.MOUSE_LEAVE,(function(){g(e).to(.1,{scale:t},{easing:"quadOut"}).start(),g(o).to(.1,{color:i}).start()})),e.on(l.EventType.TOUCH_START,(function(){g(e).to(.05,{scale:new f(.95,.95,1)},{easing:"quadOut"}).start()})),e.on(l.EventType.TOUCH_END,(function(){g(e).to(.1,{scale:new f(1.1,1.1,1)},{easing:"backOut"}).start()})),e.on(l.EventType.TOUCH_CANCEL,(function(){g(e).to(.1,{scale:t},{easing:"quadOut"}).start()}))},u.enhanceVisualStyling=function(){this.popupPanel&&g(this.popupPanel.getComponent(d)).to(2,{color:new b(255,255,255,255)}).to(2,{color:new b(255,240,200,255)}).union().repeatForever().start()},u.show=function(){if(!this.isVisible){if(this.isVisible=!0,this.node.active=!0,this.popupPanel)this.popupPanel.setScale(0,0,1),(this.popupPanel.getComponent(C)||this.popupPanel.addComponent(C)).opacity=0;if(this.backgroundOverlay)(this.backgroundOverlay.getComponent(C)||this.backgroundOverlay.addComponent(C)).opacity=0;if(this.backgroundOverlay){var n=this.backgroundOverlay.getComponent(C);g(n).to(.3,{opacity:255},{easing:"quadOut"}).start()}if(this.popupPanel){v.stopAllByTarget(this.popupPanel);var e=this.popupPanel.getComponent(C);g(this.popupPanel).parallel(g(this.popupPanel).to(.6,{scale:new f(1,1,1)},{easing:"backOut"}),g(e).to(.3,{opacity:255},{easing:"quadOut"})).start()}}},u.hide=function(n){var e=this;if(void 0===n&&(n=!0),this.isVisible||!n)if(this.isVisible=!1,n){if(this.popupPanel){var t=this.popupPanel.getComponent(C)||this.popupPanel.addComponent(C);g(this.popupPanel).to(.3,{scale:new f(.8,.8,1)},{easing:"backIn"}).start(),g(t).to(.3,{opacity:0},{easing:"quadIn"}).start()}if(this.backgroundOverlay){var o=this.backgroundOverlay.getComponent(C)||this.backgroundOverlay.addComponent(C);g(o).to(.2,{opacity:0},{easing:"quadIn"}).call((function(){e.node.active=!1})).start()}else setTimeout((function(){e.node.active=!1}),300)}else this.node.active=!1},u.setCallbacks=function(n,e){this.onContinueCallback=n,this.onNewGameCallback=e},u.onContinueClicked=function(){var n=this;this.hide(),this.onContinueCallback&&setTimeout((function(){return n.onContinueCallback()}),100)},u.onNewGameClicked=function(){var n=this;this.hide(),this.onNewGameCallback&&setTimeout((function(){return n.onNewGameCallback()}),100)},u.onSoundToggled=function(){if(this.soundToggle)for(var n,e=this.soundToggle.isChecked,t=this.node.getComponentsInChildren(m),o=a(t);!(n=o()).done;){n.value.volume=e?1:0}},u.isSoundEnabled=function(){return!this.soundToggle||this.soundToggle.isChecked},u.setSoundEnabled=function(n){this.soundToggle&&(this.soundToggle.isChecked=n,this.onSoundToggled())},u.onDestroy=function(){var n,e;if(null!=(n=this.continueButton)&&n.node&&this.continueButton.node.off(l.EventType.TOUCH_END),null!=(e=this.newGameButton)&&e.node&&this.newGameButton.node.off(l.EventType.TOUCH_END),this.popupPanel){g(this.popupPanel).stop();var t=this.popupPanel.getComponent(d);t&&g(t).stop()}if(this.backgroundOverlay){var o=this.backgroundOverlay.getComponent(C);o&&g(o).stop()}this.onContinueCallback=null,this.onNewGameCallback=null},e}(y)).prototype,"popupPanel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(G.prototype,"backgroundOverlay",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(G.prototype,"continueButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(G.prototype,"newGameButton",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(G.prototype,"soundToggle",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(G.prototype,"titleLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=G))||N));u._RF.pop()}}}));

System.register("chunks:///_virtual/ProgressManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./Singleton.ts"],(function(e){var t,n,s,o,r,i,l;return{setters:[function(e){t=e.inheritsLoose,n=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,o=e._decorator,r=e.EventTarget},function(e){i=e.GameConfig},function(e){l=e.Singleton}],execute:function(){var a;s._RF.push({},"a1b2cPU5fZ4kBI0VniQq83v","ProgressManager",void 0);var c=o.ccclass;e("ProgressManager",c("ProgressManager")(a=function(e){function s(){for(var t,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))||this).eventTarget=new r,t.currentScore=0,t.currentMilestone=0,t.moveLeft=0,t.totalMilestones=i.MilestoneSystem.milestoneThresholds.length,t.pendingMilestoneData=[],t}t(s,e);var o=s.prototype;return o.onLoad=function(){},o.onDestroy=function(){this.eventTarget.targetOff(this),this.pendingMilestoneData=[]},o.addPendingScore=function(e,t){this.pendingMilestoneData.push({matchCount:e,matchSize:t})},o.processPendingScores=function(){if(0===this.pendingMilestoneData.length)return!1;for(var e,t=0,s=n(this.pendingMilestoneData);!(e=s()).done;){var o=e.value,r=o.matchCount*i.MilestoneSystem.pointsPerTile;o.matchSize>=5?r+=i.MilestoneSystem.bonusPoints.match5Plus:4===o.matchSize&&(r+=i.MilestoneSystem.bonusPoints.match4),t+=r}this.currentScore+=t,this.pendingMilestoneData=[];var l=this.checkMilestoneCompletion();return this.eventTarget.emit("progress-updated",this.getMilestoneData()),l},o.addScore=function(e,t){var n=e*i.MilestoneSystem.pointsPerTile;t>=5?n+=i.MilestoneSystem.bonusPoints.match5Plus:4===t&&(n+=i.MilestoneSystem.bonusPoints.match4),this.currentScore+=n;var s=this.checkMilestoneCompletion();return this.eventTarget.emit("progress-updated",this.getMilestoneData()),s},o.checkMilestoneCompletion=function(){if(this.currentMilestone>=this.totalMilestones)return!1;var e=i.MilestoneSystem.milestoneThresholds[this.currentMilestone];return this.currentScore>=e&&(this.currentMilestone++,this.eventTarget.emit("milestone-completed",this.getMilestoneData()),!0)},o.getMilestoneData=function(){var e=this.currentMilestone<this.totalMilestones?i.MilestoneSystem.milestoneThresholds[this.currentMilestone]:i.MilestoneSystem.milestoneThresholds[this.totalMilestones-1],t=this.currentMilestone>0?i.MilestoneSystem.milestoneThresholds[this.currentMilestone-1]:0,n=this.currentScore-t,s=e-t,o=Math.min(n/s,1);return{currentMilestone:this.currentMilestone,currentScore:this.currentScore,currentMilestoneProgress:o,milestoneThreshold:e,totalMilestones:this.totalMilestones}},o.onProgressUpdate=function(e){this.eventTarget.on("progress-updated",e)},o.onMilestoneCompleted=function(e){this.eventTarget.on("milestone-completed",e)},o.offProgressUpdate=function(e){this.eventTarget.off("progress-updated",e)},o.offMilestoneCompleted=function(e){this.eventTarget.off("milestone-completed",e)},o.resetProgress=function(){this.currentScore=0,this.currentMilestone=0,this.moveLeft=0,this.pendingMilestoneData=[],this.eventTarget.emit("progress-updated",this.getMilestoneData())},o.getCurrentScore=function(){return this.currentScore},o.getCurrentMilestone=function(){return this.currentMilestone},o.getMoveLeft=function(){return this.moveLeft},s}(l))||a);s._RF.pop()}}}));

System.register("chunks:///_virtual/ProgressUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ProgressManager.ts","./GameConfig.ts"],(function(e){var s,o,r,t,n,a,i,l,c,h,g,d,u,b,p,L,f,m;return{setters:[function(e){s=e.applyDecoratedDescriptor,o=e.inheritsLoose,r=e.initializerDefineProperty,t=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,i=e.ProgressBar,l=e.Label,c=e.Node,h=e.Color,g=e.Vec2,d=e.tween,u=e.Vec3,b=e.UITransform,p=e.Sprite,L=e.Component},function(e){f=e.ProgressManager},function(e){m=e.GameConfig}],execute:function(){var B,w,v,M,C,S,k,y,P,z,I,O,D,U,T;n._RF.push({},"b2c3d4e5-f6g7-8901-2345-678901bcdefg","ProgressUI",void 0);var x=a.ccclass,N=a.property;e("ProgressUI",(B=x("ProgressUI"),w=N(i),v=N(l),M=N(l),C=N(l),S=N(l),k=N(c),B((z=s((P=function(e){function s(){for(var s,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return s=e.call.apply(e,[this].concat(n))||this,r(s,"progressBar",z,t(s)),r(s,"milestoneLabel",I,t(s)),r(s,"scoreLabel",O,t(s)),r(s,"progressLabel",D,t(s)),r(s,"movesLabel",U,t(s)),r(s,"celebrationNode",T,t(s)),s.progressManager=null,s.scoreBackground=null,s.progressBackground=null,s.milestoneBackground=null,s}o(s,e);var n=s.prototype;return n.start=function(){this.progressManager=f.getInstance(),this.progressManager?(this.enhanceUIElements(),this.progressManager.onProgressUpdate(this.updateProgressDisplay.bind(this)),this.progressManager.onMilestoneCompleted(this.onMilestoneCompleted.bind(this)),this.updateProgressDisplay(this.progressManager.getMilestoneData()),this.updateMovesDisplay(m.Moves)):console.error("ProgressManager not found")},n.enhanceUIElements=function(){this.enhanceScoreLabel(),this.enhanceMilestoneLabel(),this.enhanceProgressLabel(),this.enhanceProgressBar(),this.addUIBackgrounds(),this.enhanceMovesLabel()},n.enhanceMovesLabel=function(){this.movesLabel&&(this.movesLabel.color=new h(255,255,255,255),this.movesLabel.fontSize=22,this.movesLabel.isBold=!0,this.movesLabel.enableOutline=!0,this.movesLabel.outlineColor=new h(0,0,139,255),this.movesLabel.outlineWidth=2,this.movesLabel.enableShadow=!0,this.movesLabel.shadowColor=new h(0,0,0,100),this.movesLabel.shadowOffset=new g(1,-1),this.movesLabel.shadowBlur=3)},n.enhanceScoreLabel=function(){this.scoreLabel&&(this.scoreLabel.color=new h(255,215,0,255),this.scoreLabel.fontSize=28,this.scoreLabel.isBold=!0,this.scoreLabel.enableOutline=!0,this.scoreLabel.outlineColor=new h(139,69,19,255),this.scoreLabel.outlineWidth=3,this.scoreLabel.enableShadow=!0,this.scoreLabel.shadowColor=new h(255,165,0,150),this.scoreLabel.shadowOffset=new g(0,0),this.scoreLabel.shadowBlur=8)},n.enhanceMilestoneLabel=function(){this.milestoneLabel&&(this.milestoneLabel.color=new h(147,0,211,255),this.milestoneLabel.fontSize=24,this.milestoneLabel.isBold=!0,this.milestoneLabel.enableOutline=!0,this.milestoneLabel.outlineColor=new h(255,255,255,255),this.milestoneLabel.outlineWidth=2,this.milestoneLabel.enableShadow=!0,this.milestoneLabel.shadowColor=new h(0,0,0,100),this.milestoneLabel.shadowOffset=new g(1,-1),this.milestoneLabel.shadowBlur=3)},n.enhanceProgressLabel=function(){this.progressLabel&&(this.progressLabel.color=new h(0,255,255,255),this.progressLabel.fontSize=22,this.progressLabel.isBold=!0,this.progressLabel.enableOutline=!0,this.progressLabel.outlineColor=new h(0,0,139,255),this.progressLabel.outlineWidth=2)},n.enhanceProgressBar=function(){if(this.progressBar){this.progressBar.barSprite&&this.updateProgressBarColor(this.progressBar.progress);var e=this.progressBar.node;e&&d(e).to(.3,{scale:new u(1.05,1.05,1)}).to(.3,{scale:new u(1,1,1)}).union().repeatForever().start()}},n.updateProgressBarColor=function(e){var s;if(null!=(s=this.progressBar)&&s.barSprite){var o=this.getProgressBarColor(e);this.progressBar.barSprite.color=o}},n.getProgressBarColor=function(e){if(e<.3)return new h(255,Math.floor(e/.3*165),0,255);if(e<.7){var s=(e-.3)/.4;return new h(255,Math.floor(165+90*s),0,255)}var o=(e-.7)/.3;return new h(Math.floor(255-255*o),255,Math.floor(100*o),255)},n.addUIBackgrounds=function(){this.createScoreBackground(),this.createMilestoneBackground(),this.createProgressBackground()},n.createScoreBackground=function(){var e;if(this.scoreLabel){this.scoreBackground=new c("ScoreBackground"),null==(e=this.scoreLabel.node.parent)||e.addChild(this.scoreBackground),this.scoreBackground.setPosition(this.scoreLabel.node.position),this.scoreBackground.setSiblingIndex(this.scoreLabel.node.getSiblingIndex()),this.scoreBackground.addComponent(b).setContentSize(120,50);var s=this.scoreBackground.addComponent(p);s.type=p.Type.SLICED,s.sizeMode=p.SizeMode.CUSTOM,s.color=new h(139,69,19,200),d(this.scoreBackground).to(1,{scale:new u(1.1,1.1,1)}).to(1,{scale:new u(1,1,1)}).union().repeatForever().start()}},n.createMilestoneBackground=function(){var e;if(this.milestoneLabel){this.milestoneBackground=new c("MilestoneBackground"),null==(e=this.milestoneLabel.node.parent)||e.addChild(this.milestoneBackground),this.milestoneBackground.setPosition(this.milestoneLabel.node.position),this.milestoneBackground.setSiblingIndex(this.milestoneLabel.node.getSiblingIndex()),this.milestoneBackground.addComponent(b).setContentSize(160,45);var s=this.milestoneBackground.addComponent(p);s.type=p.Type.SLICED,s.sizeMode=p.SizeMode.CUSTOM,s.color=new h(75,0,130,180)}},n.createProgressBackground=function(){var e;if(this.progressBar){this.progressBackground=new c("ProgressBackground"),null==(e=this.progressBar.node.parent)||e.addChild(this.progressBackground),this.progressBackground.setPosition(this.progressBar.node.position.x,this.progressBar.node.position.y+5),this.progressBackground.setSiblingIndex(this.progressBar.node.getSiblingIndex()),this.progressBackground.addComponent(b).setContentSize(220,60);var s=this.progressBackground.addComponent(p);s.type=p.Type.SLICED,s.sizeMode=p.SizeMode.CUSTOM,s.color=new h(25,25,112,150);var o=new c("ProgressBorder");this.progressBackground.addChild(o),o.addComponent(b).setContentSize(225,65);var r=o.addComponent(p);r.type=p.Type.SLICED,r.sizeMode=p.SizeMode.CUSTOM,r.color=new h(255,215,0,100)}},n.updateProgressDisplay=function(e){var s=this;if(this.progressBar){var o=e.currentMilestoneProgress;d(this.progressBar).to(.8,{progress:o},{easing:"quartOut",onUpdate:function(){s.updateProgressBarColor(s.progressBar.progress)}}).start()}if(this.milestoneLabel){var r="Level: "+(e.currentMilestone+1);this.milestoneLabel.string!==r&&this.animateTextChange(this.milestoneLabel,r)}if(this.scoreLabel){var t="Score: "+e.currentScore.toLocaleString();this.scoreLabel.string!==t&&this.animateScoreChange(this.scoreLabel,t)}if(this.progressLabel){var n=Math.floor(100*e.currentMilestoneProgress)+"%";this.progressLabel.string!==n&&this.animateTextChange(this.progressLabel,n)}},n.animateTextChange=function(e,s){d(e.node).to(.1,{scale:new u(1.3,1.3,1)}).call((function(){e.string=s})).to(.2,{scale:new u(1,1,1)},{easing:"backOut"}).start()},n.animateScoreChange=function(e,s){var o=e.color.clone(),r=new h(255,255,255,255);d(e).to(.1,{color:r}).to(.2,{color:o}).start(),d(e.node).to(.15,{scale:new u(1.4,1.4,1)}).call((function(){e.string=s})).to(.25,{scale:new u(1,1,1)},{easing:"elasticOut"}).start()},n.onMilestoneCompleted=function(e){this.playEnhancedCelebrationAnimation(),this.updateProgressDisplay(e)},n.playEnhancedCelebrationAnimation=function(){var e=this;this.celebrateScoreLabel(),this.celebrateMilestoneLabel(),this.celebrateProgressBar(),this.celebrationNode&&(this.celebrationNode.setScale(0,0,1),this.celebrationNode.active=!0,d(this.celebrationNode).to(.4,{scale:new u(1.3,1.3,1)},{easing:"backOut"}).to(.3,{scale:new u(1,1,1)},{easing:"quadOut"}).delay(2).to(.4,{scale:new u(0,0,1)},{easing:"backIn"}).call((function(){e.celebrationNode.active=!1})).start())},n.celebrateScoreLabel=function(){var e=this;if(this.scoreLabel){var s=this.scoreLabel.color.clone(),o=[new h(255,215,0,255),new h(255,255,255,255),new h(255,165,0,255),new h(255,215,0,255)],r=0;d(this.scoreLabel).repeat(4,d(this.scoreLabel).call((function(){e.scoreLabel.color=o[r],r=(r+1)%o.length})).delay(.2)).call((function(){e.scoreLabel.color=s})).start()}},n.celebrateMilestoneLabel=function(){this.milestoneLabel&&d(this.milestoneLabel.node).to(.2,{scale:new u(1.5,1.5,1)}).to(.3,{scale:new u(1,1,1)},{easing:"bounceOut"}).start()},n.celebrateProgressBar=function(){var e,s=this;if(null!=(e=this.progressBar)&&e.barSprite){var o=this.progressBar.barSprite.color.clone(),r=[new h(255,0,0,255),new h(255,165,0,255),new h(255,255,0,255),new h(0,255,0,255),new h(0,0,255,255),new h(75,0,130,255),new h(238,130,238,255)],t=0;d(this.progressBar.barSprite).repeat(r.length,d(this.progressBar.barSprite).call((function(){s.progressBar.barSprite.color=r[t],t++})).delay(.15)).call((function(){s.progressBar.barSprite.color=o})).start()}},n.resetProgress=function(){this.progressManager&&this.progressManager.resetProgress()},n.onDestroy=function(){var e,s,o,r,t,n;this.progressManager&&(this.progressManager.offProgressUpdate(this.updateProgressDisplay.bind(this)),this.progressManager.offMilestoneCompleted(this.onMilestoneCompleted.bind(this))),null!=(e=this.progressBar)&&e.node&&d(this.progressBar.node).stop(),null!=(s=this.progressBar)&&s.barSprite&&d(this.progressBar.barSprite).stop(),null!=(o=this.scoreLabel)&&o.node&&(d(this.scoreLabel.node).stop(),d(this.scoreLabel).stop()),null!=(r=this.milestoneLabel)&&r.node&&d(this.milestoneLabel.node).stop(),null!=(t=this.progressLabel)&&t.node&&d(this.progressLabel.node).stop(),null!=(n=this.movesLabel)&&n.node&&(d(this.movesLabel.node).stop(),d(this.movesLabel).stop()),this.celebrationNode&&d(this.celebrationNode).stop(),this.scoreBackground&&this.scoreBackground.isValid&&(d(this.scoreBackground).stop(),this.scoreBackground.destroy()),this.progressBackground&&this.progressBackground.isValid&&this.progressBackground.destroy(),this.milestoneBackground&&this.milestoneBackground.isValid&&this.milestoneBackground.destroy()},n.updateMovesDisplay=function(e){if(this.movesLabel){var s="Moves: "+e;this.movesLabel.string!==s&&this.animateMovesChange(e,s)}},n.getMovesLabelColor=function(e){return e<=5?new h(255,69,0,255):e<=10?new h(255,165,0,255):new h(255,255,255,255)},n.animateMovesChange=function(e,s){var o=this;if(this.movesLabel){var r=this.getMovesLabelColor(e);d(this.movesLabel).to(.1,{color:new h(255,255,255,255)}).to(.2,{color:r}).start(),d(this.movesLabel.node).to(.1,{scale:new u(1.2,1.2,1)}).call((function(){o.movesLabel.string=s})).to(.2,{scale:new u(1,1,1)},{easing:"backOut"}).start(),e<=0?d(this.movesLabel.node).delay(.3).to(.15,{scale:new u(1.3,1.3,1)}).to(.15,{scale:new u(.9,.9,1)}).to(.15,{scale:new u(1.3,1.3,1)}).to(.15,{scale:new u(1,1,1)}).start():e<=5&&d(this.movesLabel.node).delay(.3).to(.1,{scale:new u(1.1,1.1,1)}).to(.1,{scale:new u(1,1,1)}).to(.1,{scale:new u(1.1,1.1,1)}).to(.1,{scale:new u(1,1,1)}).start()}},s}(L)).prototype,"progressBar",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=s(P.prototype,"milestoneLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=s(P.prototype,"scoreLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=s(P.prototype,"progressLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=s(P.prototype,"movesLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=s(P.prototype,"celebrationNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=P))||y));n._RF.pop()}}}));

System.register("chunks:///_virtual/SelectState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TileState.ts","./AnimationManager.ts"],(function(n){var t,e,a,i;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy},function(n){a=n.TileState},function(n){i=n.AnimationManager}],execute:function(){e._RF.push({},"f621dOHpPFLWbtXLt0mpO4n","SelectState",void 0);n("SelectState",function(n){function e(t){var e;return(e=n.call(this,t)||this).animationHandler=null,e.animationHandler=t.getComponent(i),e}t(e,n);var a=e.prototype;return a.onEnter=function(){var n;null==(n=this.animationHandler)||n.animateSelection()},a.onExit=function(){var n;null==(n=this.animationHandler)||n.animateDeselection()},a.onUpdate=function(){},a.onPlayerIdle=function(){var n;null==(n=this.animationHandler)||n.animatePlayerIdle()},e}(a));e._RF.pop()}}}));

System.register("chunks:///_virtual/Singleton.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,i;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,i=n.Component}],execute:function(){e._RF.push({},"f0d79BgePNIh6MBcfYXaFnz","Singleton",void 0),n("Singleton",function(n){function e(){return n.apply(this,arguments)||this}return t(e,n),e.getInstance=function(){if(!e.instances.has(this)){var n=new this;e.instances.set(this,n),"function"==typeof n.initialize&&n.initialize()}return e.instances.get(this)},e.hasInstance=function(){return e.instances.has(this)},e.destroyInstance=function(){e.instances.delete(this)},e.getAllInstances=function(){return new Map(e.instances)},e.clearAllInstances=function(){e.instances.clear()},e.prototype.initialize=function(){},e.getCurrentInstance=function(){return e.instances.get(this)||null},e}(i)).instances=new Map,e._RF.pop()}}}));

System.register("chunks:///_virtual/SpecialTileConfig.ts",["cc"],(function(e){var o,i;return{setters:[function(e){o=e.cclegacy,i=e.Color}],execute:function(){o._RF.push({},"c1d2e3f4-g5h6-7890-1234-567890abcdef","SpecialTileConfig",void 0);var n=e("SpecialTileType",function(e){return e.NORMAL="normal",e.BOMB="bomb",e.RAINBOW="rainbow",e.STRIPED_HORIZONTAL="striped_horizontal",e.STRIPED_VERTICAL="striped_vertical",e.WRAPPED="wrapped",e}({}));e("SpecialTileConfig",{NORMAL:{type:n.NORMAL,name:"Normal",color:new i(255,255,255,255)},BOMB:{type:n.BOMB,name:"Bomb Candy",color:new i(128,128,128,255),effectRadius:1,activationSound:"bomb_explosion"},RAINBOW:{type:n.RAINBOW,name:"Rainbow Candy",color:new i(255,255,255,255),matchesAllColors:!0,activationSound:"rainbow_burst"},STRIPED_HORIZONTAL:{type:n.STRIPED_HORIZONTAL,name:"Horizontal Striped Candy",color:new i(255,255,255,255),direction:"horizontal",activationSound:"striped_activation"},STRIPED_VERTICAL:{type:n.STRIPED_VERTICAL,name:"Vertical Striped Candy",color:new i(255,255,255,255),direction:"vertical",activationSound:"striped_activation"},WRAPPED:{type:n.WRAPPED,name:"Wrapped Candy",color:new i(255,255,255,255),effectRadius:2,activationSound:"wrapped_explosion"}});o._RF.pop()}}}));

System.register("chunks:///_virtual/SpecialTileManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SpecialTileConfig.ts","./GameConfig.ts","./BoardManager.ts","./ParticleEffectManager.ts"],(function(e){var i,n,r,a,t,o,c,l,u,s,f,d;return{setters:[function(e){i=e.inheritsLoose,n=e.createForOfIteratorHelperLoose,r=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){t=e.cclegacy,o=e._decorator,c=e.Component},function(e){l=e.SpecialTileType,u=e.SpecialTileConfig},function(e){s=e.GameConfig},function(e){f=e.BoardManager},function(e){d=e.ParticleEffectManager}],execute:function(){var p;t._RF.push({},"d2e3f4g5-h6i7-8901-2345-678901bcdefg","SpecialTileManager",void 0);var v=o.ccclass;e("SpecialTileManager",v("SpecialTileManager")(p=function(e){function t(){for(var i,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(i=e.call.apply(e,[this].concat(r))||this).boardManager=null,i.particleEffectManager=null,i}i(t,e);var o=t.prototype;return o.onLoad=function(){this.boardManager=this.node.getComponent(f),this.particleEffectManager=this.node.getComponent(d)},o.determineSpecialTileType=function(e){return 4===e.length?l.BOMB:l.RAINBOW},o.createSpecialTile=function(){var e=r(a().mark((function e(i,r,t,o){var c,l,u,s,f,d,p,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&i.node&&i.node.isValid){e.next=2;break}return e.abrupt("return");case 2:i.setSpecialType(r),null==(c=this.particleEffectManager)||c.createTileParticleEffect(i,r),l=Array(),u=t.filter((function(e){return e.node&&e.node.isValid})).length,s=0,f=function(){++s>=u&&(null==o||o())},d=n(t);case 9:if((p=d()).done){e.next=16;break}if((v=p.value)&&v.node&&v.node.isValid){e.next=13;break}return e.abrupt("continue",14);case 13:l.push(v.playCombineEffect(i,(function(){f()})));case 14:e.next=9;break;case 16:return e.next=18,Promise.all(l);case 18:case"end":return e.stop()}}),e,this)})));return function(i,n,r,a){return e.apply(this,arguments)}}(),o.activateSpecialTile=function(e,i,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e||!e.node||!e.node.isValid)return[];var t=e.getSpecialType(),o=this.boardManager.getTileGrid();if(!n)return[];switch(t){case l.BOMB:return this.activateBombTile(n.x,n.y,o,e);case l.RAINBOW:return this.activateRainbowTile(e,i,o,r,a);default:return[]}},o.activateBombTile=function(e,i,n,r){for(var a=[],t=u.BOMB.effectRadius||1,o=-t;o<=t;o++)for(var c=-t;c<=t;c++){var l=e+c,f=i+o;if(l>=0&&l<s.GridWidth&&f>=0&&f<s.GridHeight){var d=n[f][l];d&&d.node&&d.node.isValid&&!d.isRainbowTile()&&a.push(d)}}return a},o.activateRainbowTile=function(e,i,r,a,t){void 0===a&&(a=!1),void 0===t&&(t=!1);var o=[];if(t)return this.activateRainbowClick(e,i,r);if(!a)return[];if(i.isRainbowTile()){for(var c,l=n(r);!(c=l()).done;)for(var u,f=c.value,d=n(f);!(u=d()).done;){var p=u.value;p&&p.node&&p.node.isValid&&o.push(p)}return o}for(var v=0;v<s.GridHeight;v++)for(var g=0;g<s.GridWidth;g++){var h=r[v][g];h&&i&&h.getTileType()===i.getTileType()&&!h.isRainbowTile()&&o.push(h)}return o},o.activateRainbowClick=function(e,i,n){var r=[],a=new Set,t=this.boardManager.getTileCoords().get(e);if(!t)return r;var o=t.x,c=t.y,l=this.spiralTraversal(o,c,a,r,5,n,[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1}]);return r.length=0,r.push.apply(r,l),r},o.spiralTraversal=function(e,i,n,r,a,t,o){var c=this,l=[].concat(r),u=new Set(n);return function e(i,n,r,s,f,d,p){if(!(p>=a*a)){if(c.isInBounds(i,n,t)){var v=t[n][i];v&&v.node&&v.node.isValid&&!u.has(v)&&(l.push(v),u.add(v))}var g=i+o[r].x,h=n+o[r].y,T=f+1,y=p+1;if(T===s){var b=d+1;e(g,h,(r+1)%4,b%2==0?s+1:s,0,b,y)}else e(g,h,r,s,T,d,y)}}(e,i,0,1,0,0,0),l},o.isInBounds=function(e,i,n){return e>=0&&e<s.GridWidth&&i>=0&&i<s.GridHeight&&void 0!==n[i][e]},t}(c))||p);t._RF.pop()}}}));

System.register("chunks:///_virtual/Tile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./SpecialTileConfig.ts","./IdleState.ts","./SelectState.ts","./GameGlobalData.ts","./AnimationManager.ts"],(function(e){var t,n,i,o,a,s,r,l,c,u,p,h,f,d,m,w,b,S,v,g,y,T,C,k,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,a=e.createForOfIteratorHelperLoose,s=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e._decorator,u=e.Sprite,p=e.Prefab,h=e.resources,f=e.SpriteAtlas,d=e.Color,m=e.UITransform,w=e.Vec3,b=e.Component,S=e.instantiate,v=e.ParticleSystem2D},function(e){g=e.GameConfig},function(e){y=e.SpecialTileType},function(e){T=e.IdleState},function(e){C=e.SelectState},function(e){k=e.GameGlobalData},function(e){M=e.AnimationManager}],execute:function(){var R,D,A,F,P,O,z;l._RF.push({},"df56acXknlGaYhEaXrwyRVa","Tile",void 0);var E=c.ccclass,I=c.property;e("Tile",(R=E("Tile"),D=I(u),A=I(p),R((O=t((P=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,i(t,"sprite",O,o(t)),i(t,"particleEffect",z,o(t)),t.tileType=g.CandyTypes[0],t.specialType=y.NORMAL,t.isRainbow=!1,t.callbacks=[],t.currentState=null,t.states=new Map,t.correspondingFrame=null,t.mouseDownPos=null,t.isMouseDownOnThis=!1,t.clickThreshold=10,t.onRainbowClickCallbacks=[],t}n(t,e);var l=t.prototype;return l.__preload=function(){if(!this.sprite)throw new Error("Sprite is required");if(!this.particleEffect)throw new Error("Particle effect is required")},l.onLoad=function(){this.states.set("idle",new T(this)),this.states.set("select",new C(this)),this.changeState("idle"),this.node.on("mouse-down",this.onMouseDown,this),this.node.on("mouse-enter",this.onMouseEnter,this),this.node.on("mouse-leave",this.onMouseLeave,this),this.node.on("mouse-up",this.onMouseUp,this)},l.addOnClickCallback=function(e){this.callbacks.push(e)},l.removeOnClickCallback=function(e){this.callbacks=e?this.callbacks.filter((function(t){return t!==e})):[]},l.addOnMouseDownCallback=function(e){this.callbacks.push(e)},l.removeOnMouseDownCallback=function(e){e&&(this.callbacks=this.callbacks.filter((function(t){return t!==e})))},l.addOnMouseUpCallback=function(e){this.callbacks.push(e)},l.removeOnMouseUpCallback=function(e){this.callbacks=e?this.callbacks.filter((function(t){return t!==e})):[]},l.addOnRainbowClickCallback=function(e){this.onRainbowClickCallbacks.push(e)},l.removeOnRainbowClickCallback=function(e){this.onRainbowClickCallbacks=e?this.onRainbowClickCallbacks.filter((function(t){return t!==e})):[]},l.emitOnMouseDown=function(){for(var e,t=a(this.callbacks);!(e=t()).done;){(0,e.value)(this)}},l.emitOnMouseUp=function(){for(var e,t=a(this.callbacks);!(e=t()).done;){(0,e.value)(this)}},l.getTileType=function(){return this.tileType},l.setTileType=function(e){this.tileType=e,this.updateTileAppearance()},l.getSpecialType=function(){return this.specialType},l.setSpecialType=function(e){this.specialType=e,this.isRainbow=e===y.RAINBOW,this.updateTileAppearance()},l.isSpecial=function(){return this.specialType!==y.NORMAL},l.setRainbowTile=function(e){this.isRainbow=e,this.updateTileAppearance()},l.isRainbowTile=function(){return this.isRainbow},l.canMatchWith=function(e){return!(!this.isRainbow&&!e.isRainbow)||this.tileType===e.tileType},l.updateTileAppearance=function(){this.isRainbow?this.updateRainbowAppearance():this.specialType===y.BOMB?this.updateBombAppearance():this.specialType===y.STRIPED_HORIZONTAL?this.updateStripedAppearance("horizontal"):this.specialType===y.STRIPED_VERTICAL?this.updateStripedAppearance("vertical"):this.specialType===y.WRAPPED?this.updateWrappedAppearance():this.updateNormalAppearance()},l.updateNormalAppearance=function(){var e=this;h.load("images/atlas/candies",f,(function(t,n){if(t)console.error("Failed to load atlas: "+t);else if(e.tileType){var i=n.getSpriteFrame(e.tileType.name);if(i)e.sprite.spriteFrame=i,e.sprite.color=new d(255,255,255,255),e.sprite.node.getComponent(m).setContentSize(g.SpriteSize,g.SpriteSize);else console.error("Sprite frame for "+e.tileType.name+" not found in atlas")}else console.error("Tile type is not set")}))},l.updateBombAppearance=function(){var e=this;h.load("images/atlas/candies",f,(function(t,n){if(t)console.error("Failed to load atlas: "+t);else{var i=n.getSpriteFrame(e.tileType.name);i&&(e.sprite.spriteFrame=i),e.sprite.node.getComponent(m).setContentSize(g.SpriteSize,g.SpriteSize)}}))},l.updateStripedAppearance=function(e){var t=this;h.load("images/atlas/candies",f,(function(e,n){if(e)console.error("Failed to load atlas: "+e);else{var i=n.getSpriteFrame(t.tileType.name);i&&(t.sprite.spriteFrame=i),t.sprite.color=new d(200,200,255,255),t.sprite.node.getComponent(m).setContentSize(g.SpriteSize,g.SpriteSize)}}))},l.updateWrappedAppearance=function(){var e=this;h.load("images/atlas/candies",f,(function(t,n){if(t)console.error("Failed to load atlas: "+t);else{var i=n.getSpriteFrame(e.tileType.name);i&&(e.sprite.spriteFrame=i),e.sprite.color=new d(255,255,200,255),e.sprite.node.getComponent(m).setContentSize(g.SpriteSize,g.SpriteSize)}}))},l.updateRainbowAppearance=function(){var e=this;this.sprite.color=new d(255,255,255,255),h.load("images/atlas/candies",f,(function(t,n){if(t)console.error("Failed to load rainbow sprite: "+t);else{var i=n.getSpriteFrame("Rainbow Candy");i?e.sprite.spriteFrame=i:console.error("Sprite frame for Rainbow Candy not found in atlas"),e.sprite.node.getComponent(m).setContentSize(g.SpriteSize,g.SpriteSize)}}))},l.changeState=function(e){var t;if(this.states){if(this.states.has(e)){var n=this.states.get(e);n?this.currentState!==n&&(null==(t=this.currentState)||t.onExit(),this.currentState=n,this.currentState.onEnter()):console.error("State "+e+" not found")}}else console.warn("Tile states not initialized or tile has been destroyed")},l.getCurrentStateName=function(){for(var e,t=a(this.states.entries());!(e=t()).done;){var n=e.value,i=n[0];if(n[1]===this.currentState)return i}return"unknown"},l.getSprite=function(){return this.sprite},l.setFrame=function(e){this.correspondingFrame=e},l.getFrame=function(){return this.correspondingFrame},l.onPlayerIdle=function(){var e;null==(e=this.currentState)||e.onPlayerIdle()},l.onMouseDown=function(e){this.isMouseDownOnThis=!0,this.mouseDownPos=new w(e.getLocationX(),e.getLocationY(),0),k.getInstance().setIsMouseDown(!0);for(var t,n=a(this.callbacks);!(t=n()).done;){(0,t.value)(this)}},l.onMouseEnter=function(e){if(this.correspondingFrame&&this.correspondingFrame.triggerMouseEnter(),k.getInstance().getIsMouseDown())for(var t,n=a(this.callbacks);!(t=n()).done;){(0,t.value)(this)}},l.onMouseLeave=function(e){this.correspondingFrame&&this.correspondingFrame.triggerMouseLeave()},l.onMouseUp=function(e){var t=this.isMouseDownOnThis;if(this.isMouseDownOnThis=!1,t&&this.mouseDownPos&&this.isRainbowTile()){var n=new w(e.getLocationX(),e.getLocationY(),0);if(w.distance(this.mouseDownPos,n)<=this.clickThreshold){for(var i,o=a(this.onRainbowClickCallbacks);!(i=o()).done;){(0,i.value)(this)}return this.mouseDownPos=null,void k.getInstance().setIsMouseDown(!1)}}this.mouseDownPos=null;for(var s,r=a(this.callbacks);!(s=r()).done;){(0,s.value)(this)}k.getInstance().setIsMouseDown(!1)},l.onDestroy=function(){var e;this.callbacks=[],this.onRainbowClickCallbacks=[],this.node&&this.node.isValid&&(this.node.off("mouse-down",this.onMouseDown,this),this.node.off("mouse-enter",this.onMouseEnter,this),this.node.off("mouse-leave",this.onMouseLeave,this),this.node.off("mouse-up",this.onMouseUp,this)),null==(e=this.currentState)||e.onExit()},l.playParticleEffect=function(){var e=s(r().mark((function e(t){var n=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){if(!n.particleEffect||!n.node||!n.node.isValid)return console.warn("Particle effect prefab is not assigned or node is invalid"),null==t||t(),void e();var i=S(n.particleEffect);n.node.parent.addChild(i),i.setPosition(n.node.getPosition());var o=i.getComponent(v);o&&(o.startColor=n.tileType.color,o.startColorVar=new d(0,0,0,255),o.endColor=n.tileType.color,o.endColorVar=new d(0,0,0,255),o.playOnLoad=!0),null==t||t(),e()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.playDestroyAnimation=function(e){var t=this;return new Promise((function(n){if(!t.node||!t.node.isValid)return console.warn("Cannot play destroy animation: node is null or invalid"),null==e||e(),void n();var i=t.node.getComponent(M);i?i.animateDestroy(e,n):(console.warn("AnimationManager not found on tile node"),null==e||e(),n())}))},l.playCombineEffect=function(e,t){var n=this;return new Promise((function(i){if(!(n.node&&n.node.isValid&&e.node&&e.node.isValid))return console.warn("Cannot play combine effect: node is null or invalid"),null==t||t(),void i();var o=n.node.getComponent(M);o?o.animateCombine(n,e,t,i):(console.warn("AnimationManager not found on tile node"),null==t||t(),i())}))},t}(b)).prototype,"sprite",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(P.prototype,"particleEffect",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=P))||F));l._RF.pop()}}}));

System.register("chunks:///_virtual/TileState.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"ea6eexfy39MQLyAmofkj/wD","TileState",void 0);t("TileState",(function(t){this.tile=void 0,this.tile=t}));e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});